<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="在学习的路上，不忘初心 方得始终">
<meta property="og:type" content="website">
<meta property="og:title" content="兜兜转转的技术博客">
<meta property="og:url" content="http://fgyong.cn/index.html">
<meta property="og:site_name" content="兜兜转转的技术博客">
<meta property="og:description" content="在学习的路上，不忘初心 方得始终">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="兜兜转转的技术博客">
<meta name="twitter:description" content="在学习的路上，不忘初心 方得始终">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://fgyong.cn/"/>





  <title>兜兜转转的技术博客</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">兜兜转转的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">不忘初心 方得始终</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fgyong.cn/2018/04/16/mac-php5-6+mongdb+Apache环境配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="兜兜转转">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兜兜转转的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/16/mac-php5-6+mongdb+Apache环境配置/" itemprop="url">PHP5.6+YII+MongoDB环境搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-16T15:39:24+08:00">
                2018-04-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据结构/" itemprop="url" rel="index">
                    <span itemprop="name">数据结构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-安装php5-6"><a href="#1-安装php5-6" class="headerlink" title="1.安装php5.6"></a>1.安装php5.6</h3><h5 id="1-先安装brew，要是不确定是否已经安装了brew，可以先运行brew-v查看版本，有版本号的话直接下一步，报错的话安装brew。"><a href="#1-先安装brew，要是不确定是否已经安装了brew，可以先运行brew-v查看版本，有版本号的话直接下一步，报错的话安装brew。" class="headerlink" title="1.先安装brew，要是不确定是否已经安装了brew，可以先运行brew -v查看版本，有版本号的话直接下一步，报错的话安装brew。"></a>1.先安装brew，要是不确定是否已经安装了brew，可以先运行<code>brew -v</code>查看版本，有版本号的话直接下一步，报错的话安装brew。</h5><p>安装命令是<code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code>有其他问题可以查看<a href="https://brew.sh/index_zh-cn" target="_blank" rel="external">brew官方安装方法</a>。</p>
<h5 id="2-搜索PHP"><a href="#2-搜索PHP" class="headerlink" title="2.搜索PHP"></a>2.搜索PHP</h5><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">brew </span>search php</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/783986-58be6a637b83983b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="brew search php"></p>
<h3 id="3-安装PHP"><a href="#3-安装PHP" class="headerlink" title="3.安装PHP"></a>3.安装PHP</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">brew</span> <span class="selector-tag">install</span> <span class="selector-tag">php</span>@<span class="keyword">5</span>.<span class="keyword">6</span></div></pre></td></tr></table></figure>
<p>OK，安装完成。</p>
<h3 id="2-安装MongoDB"><a href="#2-安装MongoDB" class="headerlink" title="2.安装MongoDB"></a>2.安装MongoDB</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">sudo brew install mongodb <span class="comment">#安装MongoDB</span></div><div class="line"></div><div class="line">sudo mongod <span class="comment">#启动</span></div><div class="line"></div><div class="line"><span class="comment"># 如果没有创建全局路径 PATH，需要进入以下目录</span></div><div class="line">cd /usr/<span class="built_in">local</span>/mongodb/bin</div><div class="line">sudo ./mongod</div><div class="line"></div><div class="line"></div><div class="line">$ cd /usr/<span class="built_in">local</span>/mongodb/bin </div><div class="line">$ ./mongo</div><div class="line">MongoDB <span class="built_in">shell</span> <span class="built_in">version</span> v3<span class="number">.4</span><span class="number">.2</span></div><div class="line">connecting <span class="built_in">to</span>: mongodb://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">27017</span></div><div class="line">MongoDB server <span class="built_in">version</span>: <span class="number">3.4</span><span class="number">.2</span></div><div class="line">Welcome <span class="built_in">to</span> <span class="keyword">the</span> MongoDB <span class="built_in">shell</span>.</div><div class="line">……</div><div class="line">&gt; <span class="number">1</span> + <span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line">&gt;</div></pre></td></tr></table></figure>
<h3 id="3-配置Apache"><a href="#3-配置Apache" class="headerlink" title="3.配置Apache"></a>3.配置Apache</h3><p>不知道mac的Apache目录的可以使用命令<code>which apache</code>，一般的配置文件目录是<code>/etc/apache2</code>，Apahce启动的时候读的文件是http.conf，现在我们配置http.conf<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">因为我配置了两个web，所以监听 <span class="number">80</span> 和 <span class="number">81</span></div><div class="line">  Listen <span class="number">80</span></div><div class="line">  Listen <span class="number">81</span></div><div class="line"><span class="comment">#加载PHP动态库的配置，如果是用的PHP7.1或者其他版本，路径改为相对应版本的路径。加入是使用brew安装的PHP5.6的话，路径应该是我的路径。</span></div><div class="line"><span class="comment">#PHP7.1的路径</span></div><div class="line">LoadModule php7_module libexec/apache2/libphp7.so</div><div class="line"><span class="comment">#php5.6的路径</span></div><div class="line"> LoadModule php5_module /usr/local/opt/php@<span class="number">5.6</span>/<span class="class"><span class="keyword">lib</span>/<span class="title">httpd</span>/<span class="title">modules</span>/<span class="title">libphp5</span>.<span class="title">so</span></span></div><div class="line"></div><div class="line">&lt;VirtualHost *:<span class="number">81</span>&gt;    <span class="comment">#ServerAdmin demo@demo.com    </span></div><div class="line"> DocumentRoot <span class="string">"/Users/Jerry/Desktop/s/api/web"</span>    </div><div class="line"> ServerName demo.com         </div><div class="line">&lt;Directory <span class="string">"/Users/Jerry/Desktop/s/api/web"</span>&gt;   </div><div class="line">      Options +Indexes +Includes +FollowSymLinks +MultiViews     </div><div class="line">    AllowOverride All         Require local         Require all granted       </div><div class="line">  IndexIgnore *<span class="regexp">/*         RewriteEngine on         RewriteCond %</span></div><div class="line">&#123;REQUEST_FILENAME&#125; !-f         RewriteCond %</div><div class="line">&#123;REQUEST_FILENAME&#125; !-d         RewriteRule . index.php       </div><div class="line">&lt;/Directory&gt;    </div><div class="line"> ErrorLog <span class="string">"/private/var/log/apache2/demo.com-</span></div><div class="line">error_log"    </div><div class="line"> CustomLog <span class="string">"/private/var/log/apache2/demo.com-</span></div><div class="line">access_log" common</div><div class="line"> &lt;<span class="regexp">/VirtualHost&gt;</span></div><div class="line">            AllowOverride None         Require all granted    </div><div class="line">     IndexIgnore */*         RewriteEngine on         RewriteCond %</div><div class="line">&#123;REQUEST_FILENAME&#125; !-f         RewriteCond %</div><div class="line">&#123;REQUEST_FILENAME&#125; !-d         RewriteRule . index.php     </div><div class="line">&lt;<span class="regexp">/Directory&gt;  </span></div><div class="line">   ErrorLog "/private<span class="regexp">/var/log</span><span class="regexp">/apache2/demo</span>2.com-error_log<span class="string">"  </span></div><div class="line">   CustomLog "/<span class="keyword">private</span>/var/log/apache2/demo2.com-access_log<span class="string">" </span></div><div class="line">common &lt;/VirtualHost&gt;</div></pre></td></tr></table></figure></p>
<p>配置好Apache需要重新启动，<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo <span class="meta-keyword">/usr/</span>sbin/apachectl restart <span class="meta">#重新启动</span></div><div class="line">sudo <span class="meta-keyword">/usr/</span>sbin/apachectl start<span class="meta">#启动</span></div><div class="line">sudo <span class="meta-keyword">/usr/</span>sbin/apachectl stop<span class="meta">#停止</span></div></pre></td></tr></table></figure></p>
<p>在<br><code>/Users/Jerry/Desktop/s/api/web</code>新建index.html，内容是<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="section">&lt;?php</span></div><div class="line">phpinfo();</div><div class="line">&gt;</div></pre></td></tr></table></figure></p>
<p>添加url到hosts<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">vi  /etc/hosts</div><div class="line"><span class="meta">#添加 </span></div><div class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.7</span> demo.com</div><div class="line"><span class="meta">#保存退出</span></div><div class="line">:wq</div><div class="line"><span class="meta">#刷新hosts立即生效</span></div><div class="line">source /etc/hosts</div></pre></td></tr></table></figure></p>
<p>在浏览器中输入<a href="http://demo.com/,回车，出来的界面是" target="_blank" rel="external">http://demo.com/,回车，出来的界面是</a><br><img src="https://upload-images.jianshu.io/upload_images/783986-e1b5fda1f7385967.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PHPinfo"><br>这就代表运行成功了，其实这个界面包含很多配置信息，左边是参数，右边是值，例如：<br>Server API 值是Apache 2.0Handler。</p>
<p>已经有项目的，可以<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git <span class="keyword">clone</span> <span class="title">git</span>地址 dirName <span class="comment">#克隆仓库</span></div><div class="line">cd ./dicNme <span class="comment">#进入工程文件</span></div><div class="line">composer install <span class="comment">#安装 composer</span></div></pre></td></tr></table></figure></p>
<p>有什么疑问的小伙伴可以留言哦。<br>更多博客在www.fgyong.cn可见。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fgyong.cn/2017/05/08/排序算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="兜兜转转">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兜兜转转的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/08/排序算法/" itemprop="url">排序算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-08T16:39:24+08:00">
                2017-05-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据结构/" itemprop="url" rel="index">
                    <span itemprop="name">数据结构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="排序算法"><a href="#排序算法" class="headerlink" title="排序算法"></a>排序算法</h2><ul>
<li>冒泡排序</li>
<li>选择排序</li>
<li>直接插入排序</li>
<li>希尔排序</li>
<li>快速排序</li>
</ul>
<h3 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h3><blockquote>
<p>冒泡排序是一种交换排序，基本思想是两两相邻的记录的关键字，如果反序则交换，知道没有反序为止。</p>
</blockquote>
<p>冒泡排序的复杂度是n(n-1)/2,就是o(n²)。</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*对顺序列表排序*/</span></div><div class="line">-(void)<span class="built_in">sort</span>:(NSMutableArray *)<span class="built_in">list</span>&#123;</div><div class="line">    NSInteger i , j;</div><div class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="built_in">list</span>.<span class="built_in">count</span>; i ++) &#123;</div><div class="line">        <span class="keyword">for</span> (j = <span class="built_in">list</span>.<span class="built_in">count</span>-<span class="number">1</span>; j&gt;=i; j --) &#123;</div><div class="line">            <span class="keyword">if</span> (<span class="built_in">list</span>[j] &gt; <span class="built_in">list</span>[i]) &#123;</div><div class="line">                <span class="comment">/*</span></div><div class="line">                 交换obj</div><div class="line">                 */</div><div class="line">                [<span class="built_in">list</span> exchangeObjectAtIndex:i withObjectAtIndex:j];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h3><blockquote>
<p>简单选择排序法是通过n-i次关键字间的比较，从n-i+1个记录选出关键字最小的记录，并和第i（1=《i《=n）交换之。</p>
</blockquote>
<p>选择排序复杂度是n（n-1）/2,就是o（n²），性能略优于冒泡。</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">-(void)<span class="built_in">sort</span>:(NSMutableArray *)<span class="built_in">list</span>&#123;</div><div class="line">    NSInteger i , j , <span class="built_in">min</span>;</div><div class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; <span class="built_in">list</span>.<span class="built_in">count</span>; i ++) &#123;</div><div class="line">        <span class="built_in">min</span> = i; <span class="comment">//默认最小值是第一个</span></div><div class="line">        <span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt;= <span class="built_in">list</span>.<span class="built_in">count</span>; j ++) &#123;</div><div class="line">            <span class="keyword">if</span> (<span class="built_in">list</span>[<span class="built_in">min</span>]  &gt;  <span class="built_in">list</span>[j] ) &#123;</div><div class="line">                <span class="built_in">min</span> = j; <span class="comment">//记录最小值的索引</span></div><div class="line">                </div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">min</span> != i) &#123;<span class="comment">// 出现最小的值的时候 和上个最小的值交换位置</span></div><div class="line">            <span class="comment">/*</span></div><div class="line">             交换obj</div><div class="line">             */</div><div class="line">            [<span class="built_in">list</span> exchangeObjectAtIndex:i withObjectAtIndex:j];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>###直接插入排序算法</p>
<blockquote>
<p>直接插入排序的基本操作是将一个记录插入到已经排好的有序表中，从而得到一个新的，记录增加1的有序表。</p>
</blockquote>
<p>直接插入排序时间复杂度是（n+4）（n-1）/2，就是o（n²）。<br>性能略优于选择排序。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">-(<span class="keyword">void</span>)sort2:(NSMutableArray *)<span class="built_in">list</span>&#123;</div><div class="line">    NSInteger i , j ;</div><div class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; <span class="built_in">list</span>.count; i ++) &#123;</div><div class="line">       </div><div class="line">        <span class="keyword">if</span> (<span class="built_in">list</span>[i<span class="number">-1</span>] &lt; <span class="built_in">list</span>[i]) &#123;<span class="comment">// i-1 小于 i</span></div><div class="line">             NSInteger data = [<span class="built_in">list</span>[i] integerValue];<span class="comment">//设置哨兵</span></div><div class="line">            <span class="keyword">for</span> (j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span> &amp;&amp; [<span class="built_in">list</span>[j] integerValue] &lt; data  ; j --) &#123;</div><div class="line">                <span class="built_in">list</span>[j+<span class="number">1</span>] = <span class="built_in">list</span>[j];<span class="comment">//向后移动一位</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (data) &#123;</div><div class="line">                 <span class="built_in">list</span>[j+<span class="number">1</span>] =@(data);<span class="comment">//哨兵赋值</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h3><blockquote>
<p>希尔排序是把记录按下标的一定增量分组，对每组使用直接插入排序算法排序；随着增量逐渐减少，每组包含的关键词越来越多，当增量减至1时，整个文件恰被分成一组，算法便终止。</p>
</blockquote>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//希尔排序算法</span></div><div class="line">-(void)shellSort:(NSMutableArray *)<span class="built_in">list</span>&#123;</div><div class="line">    NSInteger i , j ;</div><div class="line">    NSInteger inrement = <span class="built_in">list</span>.<span class="built_in">count</span>;</div><div class="line">    <span class="keyword">do</span> &#123;</div><div class="line">        inrement = inrement/<span class="number">3</span> + <span class="number">1</span>;<span class="comment">//增量序列</span></div><div class="line">        <span class="keyword">for</span> (i = inrement+<span class="number">1</span>; i &lt; <span class="built_in">list</span>.<span class="built_in">count</span>; i ++) &#123;</div><div class="line">            <span class="keyword">if</span> (<span class="built_in">list</span>[i]&lt;<span class="built_in">list</span>[i-inrement]) &#123;</div><div class="line">                <span class="comment">//需将list[i] 插入有序增量字表</span></div><div class="line">                NSNumber  * data = <span class="built_in">list</span>[i];</div><div class="line">                <span class="keyword">for</span> (j = i - inrement; j &gt;<span class="number">0</span> &amp;&amp; data &lt; <span class="built_in">list</span>[j]; j-= inrement) &#123;</div><div class="line">                    <span class="built_in">list</span>[j+inrement] = <span class="built_in">list</span>[j];<span class="comment">//记录后移</span></div><div class="line">                &#125;</div><div class="line">                <span class="built_in">list</span>[j+inrement] = data;<span class="comment">//插入</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;<span class="keyword">while</span> (inrement &gt; <span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>希尔排序和直接插入排序有异曲同工之妙，都是记录后移，都是插入排序。不过希尔用的条件是步长，步长越来越短，直到是1，而直接插入排序是直接是1，循环次数多。<br>时间复杂度是o(n的二分之三次方)，优于o（n²）。</p>
<h3 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h3><blockquote>
<p>基本思想是:通过一趟排序将带排序记录分割成独立的两部分，其中一部分记录的关键字均比另外一部分的关键字小，则可分别对着两部分重新排序，以达到整个序列的有序的目的。</p>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 快速排序</span></div><div class="line">-(<span class="keyword">void</span>)<span class="string">quickSort:</span>(NSMutableArray *)list&#123;</div><div class="line">    [self <span class="string">qsort:</span>list <span class="string">low:</span><span class="number">0</span> <span class="string">hight:</span>list.count<span class="number">-1</span>];</div><div class="line">&#125;</div><div class="line">-(<span class="keyword">void</span>)<span class="string">qsort:</span>(NSMutableArray *)list <span class="string">low:</span>(NSInteger)low <span class="string">hight:</span>(NSInteger ) hight&#123;</div><div class="line">    NSInteger pt;</div><div class="line">    <span class="keyword">if</span> (low &lt; hight) &#123;</div><div class="line">        pt =[self <span class="string">partition:</span>list <span class="string">low:</span>low <span class="string">high:</span>hight];<span class="comment">//将整个序列一分为二</span></div><div class="line">        [self <span class="string">qsort:</span>list <span class="string">low:</span>low <span class="string">hight:</span>pt <span class="number">-1</span>];<span class="comment">//对低子表递归排序</span></div><div class="line">        [self <span class="string">qsort:</span>list <span class="string">low:</span>pt + <span class="number">1</span> <span class="string">hight:</span>hight];<span class="comment">//对高字表递归排序</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//返回在他前后记录均不大（小）与他。</span></div><div class="line">-(NSInteger)<span class="string">partition:</span>(NSMutableArray *)list <span class="string">low:</span>(NSInteger)low <span class="string">high:</span>(NSInteger)high&#123;</div><div class="line">    NSNumber * data = list[low];</div><div class="line">    <span class="keyword">while</span> (low &lt; high) &#123;</div><div class="line">        <span class="keyword">while</span> (low &lt; high &amp;&amp; list[high] &gt;= data)<span class="comment">// 倒叙 找出比data小的 并交换位置</span></div><div class="line">            high --;</div><div class="line">            [list <span class="string">exchangeObjectAtIndex:</span>low <span class="string">withObjectAtIndex:</span>high];</div><div class="line">        </div><div class="line">        <span class="keyword">while</span> (low &lt; high &amp;&amp; list[low] &lt;= data)<span class="comment">//正序 找出比data大的 并交换位置</span></div><div class="line">            low ++;</div><div class="line">         [list <span class="string">exchangeObjectAtIndex:</span>low <span class="string">withObjectAtIndex:</span>high];</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> low;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>时间复杂度是o（n²）空间复杂度是o（log n）。</p>
<p>优化选择枢轴<br>三数取中发，就是取三个关键字排序，将中间的数作为枢轴，一般是取左，右，中间三个数。<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">  data = <span class="built_in">list</span>[low];</div><div class="line"></div><div class="line">将上面的一行改成下边的：</div><div class="line"></div><div class="line">NSNumber * data;</div><div class="line">    NSInteger m = low + (high + low)/<span class="number">2</span>;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">list</span>[low] &gt; <span class="built_in">list</span>[high]) &#123;</div><div class="line">        [<span class="built_in">list</span> exchangeObjectAtIndex:low withObjectAtIndex:high];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">list</span>[m] &gt; <span class="built_in">list</span>[high]) &#123;</div><div class="line">        [<span class="built_in">list</span> exchangeObjectAtIndex:m withObjectAtIndex:high];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">list</span>[m] &gt; <span class="built_in">list</span>[low]) &#123;</div><div class="line">        [<span class="built_in">list</span> exchangeObjectAtIndex:m withObjectAtIndex:low];</div><div class="line">    &#125;</div><div class="line">    data = <span class="built_in">list</span>[low];</div></pre></td></tr></table></figure></p>
<p>优化不必要的交换<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//返回在他前后记录均不大（小）与他。</span></div><div class="line">-(NSInteger)partition:(NSMutableArray *)<span class="built_in">list</span> low:(NSInteger)low high:(NSInteger)high&#123;</div><div class="line">    NSNumber * data;</div><div class="line">    NSInteger m = low + (high - low)/<span class="number">2</span>;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">list</span>[low] &gt; <span class="built_in">list</span>[high]) &#123;</div><div class="line">        [<span class="built_in">list</span> exchangeObjectAtIndex:low withObjectAtIndex:high];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">list</span>[m] &gt; <span class="built_in">list</span>[high]) &#123;</div><div class="line">        [<span class="built_in">list</span> exchangeObjectAtIndex:m withObjectAtIndex:high];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">list</span>[m] &gt; <span class="built_in">list</span>[low]) &#123;</div><div class="line">        [<span class="built_in">list</span> exchangeObjectAtIndex:m withObjectAtIndex:low];</div><div class="line">    &#125;</div><div class="line">    data = <span class="built_in">list</span>[low];<span class="comment">//取出来适当的关键字</span></div><div class="line">    <span class="keyword">while</span> (low &lt; high) &#123;</div><div class="line">        <span class="keyword">while</span> (low &lt; high &amp;&amp; <span class="built_in">list</span>[high] &gt;= data)<span class="comment">// 倒叙 找出比data小的 并交换位置</span></div><div class="line">            high --;</div><div class="line">        <span class="built_in">list</span>[low] = <span class="built_in">list</span>[high];  <span class="comment">//将 上面的交换改成直接赋值</span></div><div class="line">        </div><div class="line">        <span class="keyword">while</span> (low &lt; high &amp;&amp; <span class="built_in">list</span>[low] &lt;= data)<span class="comment">//正序 找出比data大的 并交换位置</span></div><div class="line">            low ++;</div><div class="line">         <span class="built_in">list</span>[high ] = <span class="built_in">list</span>[low];   <span class="comment">//将 上面的交换改成直接赋值</span></div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="built_in">list</span>[low] = data; <span class="comment">//最后 将关键字 赋值给low的位置</span></div><div class="line">    <span class="keyword">return</span> low;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fgyong.cn/2017/05/07/二叉树的4种遍历/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="兜兜转转">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兜兜转转的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/07/二叉树的4种遍历/" itemprop="url">二叉树的4种遍历</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-07T16:39:24+08:00">
                2017-05-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据结构/" itemprop="url" rel="index">
                    <span itemprop="name">数据结构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="树"><a href="#树" class="headerlink" title="树"></a>树</h2><blockquote>
<p>定义:二叉树是n（n&gt;0）个节点的有限集合，该集合或者为空集（空二叉树）,或者由一个根节点和两棵互不相交分别称为根节点的左子树和右子树的二叉树组成。</p>
</blockquote>
<p><strong><em> 注意：</em></strong></p>
<ul>
<li>n&gt;0 时节点是唯一的，不可能存在多个节点，别和现实中的树木混在一起。</li>
<li>m&gt;0 时，子树的个数没有限制，但是一定是不交互的。</li>
</ul>
<h2 id="树的四种遍历"><a href="#树的四种遍历" class="headerlink" title="树的四种遍历"></a>树的四种遍历</h2><blockquote>
<p>遍历：二叉树的遍历是指从根节点出发,按照某种次序依次访问二叉树中所有节点,使得每个节点被访问依次且被访问依次。</p>
</blockquote>
<ul>
<li>前序遍历</li>
<li>中序遍历</li>
<li>后序遍历</li>
<li>层序遍历</li>
</ul>
<h3 id="前序遍历"><a href="#前序遍历" class="headerlink" title="前序遍历"></a>前序遍历</h3><blockquote>
<p>定义：规则是若二叉树为空，则空操作返回。 否则先访问跟节点，然后前序遍历左子树，再遍历右子树。优先级：根-&gt;左-&gt;右</p>
</blockquote>
<h3 id="中序遍历"><a href="#中序遍历" class="headerlink" title="中序遍历"></a>中序遍历</h3><blockquote>
<p>定义：规则是树若为空，操作返回，否则从根节点开始，中序遍历(注意并不是访问根节点)根节点的左子树，然后访问根节点，最后中序遍历右子树。优先级：左-&gt;根-&gt;右</p>
</blockquote>
<h3 id="后序遍历"><a href="#后序遍历" class="headerlink" title="后序遍历"></a>后序遍历</h3><blockquote>
<p>定义：规则是若树空,操作返回，否则是从左到右先叶子后节点的方式遍历访问左右子树，最后是访问跟节点。优先级：左-&gt;右-&gt;根</p>
</blockquote>
<h3 id="层序遍历"><a href="#层序遍历" class="headerlink" title="层序遍历"></a>层序遍历</h3><blockquote>
<p>定义：规则是若树空,操作返回，否则是从树的第一层，也就是从根节点开始访问，从上而下逐层遍历，在同一层中，从左到右的顺序对节点逐个访问。优先级：左-&gt;右-&gt;根</p>
</blockquote>
<h2 id="代码示例4中遍历"><a href="#代码示例4中遍历" class="headerlink" title="代码示例4中遍历"></a>代码示例4中遍历</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="crmsh">这四种遍历示例：   </span></div><div class="line"></div><div class="line">             A</div><div class="line">          /    \</div><div class="line">        B        C</div><div class="line">      /  \      /  \ </div><div class="line">     D    E     F   G  </div><div class="line"> 层序遍历结果是:  ABCDEFG</div><div class="line"> 前序遍历结果是:  ABDECFG</div><div class="line"> 中序遍历结果是:  DBEAFCG</div><div class="line"> 后序遍历结果是:  DEBFGCA</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">//节点对象</div><div class="line">@interface <span class="keyword">Node</span> <span class="title">: NSObject</span></div><div class="line"></div><div class="line">@<span class="keyword">property</span><span class="title"> </span>(nonatomic) NSInteger data;//存储的数据</div><div class="line"></div><div class="line">@<span class="keyword">property</span><span class="title"> </span>(nonatomic) <span class="keyword">Node</span> <span class="title">* leftNode</span>; //左节点</div><div class="line"></div><div class="line">@<span class="keyword">property</span><span class="title"> </span>(nonatomic) <span class="keyword">Node</span> <span class="title">* rightNode</span>; //右节点</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation <span class="keyword">Node</span></div><div class="line"></div><div class="line"><span class="title">@end</span></div></pre></td></tr></table></figure>
<p>每一种遍历其实都是递归，只是递归的时候，处理数据的代码时机不一样。<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//前序 遍历</div><div class="line">/*</div><div class="line"> 规则是若二叉树为空，则空操作返回。 否则先访问跟节点，然后前序遍历左子树，再遍历右子树。跟-&gt;左-&gt;右</div><div class="line"> </div><div class="line"> */</div><div class="line">-(void)printNode:(<span class="keyword">Node</span> <span class="title">*)node</span>&#123;</div><div class="line">    if (<span class="keyword">node</span> <span class="title">== nil</span>) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    NSLog(@<span class="string">"%ld"</span>,<span class="keyword">node</span>.<span class="title">data</span>);</div><div class="line">    [self printNode:<span class="keyword">node</span>.<span class="title">leftNode</span>];</div><div class="line">    [self printNode:<span class="keyword">node</span>.<span class="title">rightNode</span>];</div><div class="line">&#125;</div><div class="line">// 中序遍历   从 左子树【左-&gt;跟-&gt;右】</div><div class="line">-(void)printCenterNode:(<span class="keyword">Node</span> <span class="title">*)node</span>&#123;</div><div class="line">    if (<span class="keyword">node</span> <span class="title">== nil</span>) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    [self printCenterNode:<span class="keyword">node</span>.<span class="title">leftNode</span>];</div><div class="line">     NSLog(@<span class="string">"%ld"</span>,<span class="keyword">node</span>.<span class="title">data</span>);</div><div class="line">    [self printCenterNode:<span class="keyword">node</span>.<span class="title">rightNode</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 后序遍历   从 左子树【左-&gt;右-&gt;跟】</div><div class="line">-(void)print2Node:(<span class="keyword">Node</span> <span class="title">*)node</span>&#123;</div><div class="line">    if (<span class="keyword">node</span> <span class="title">== nil</span>) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    [self print2Node:<span class="keyword">node</span>.<span class="title">leftNode</span>];</div><div class="line">    [self print2Node:<span class="keyword">node</span>.<span class="title">rightNode</span>];</div><div class="line">    NSLog(@<span class="string">"%ld"</span>,<span class="keyword">node</span>.<span class="title">data</span>);//节点数据可以进行其他操作</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> 层序遍历暂时没有代码示例。</div><div class="line"> */</div><div class="line"></div><div class="line">//构造节点</div><div class="line">-(<span class="keyword">Node</span> <span class="title">*)randNode</span>&#123;</div><div class="line">    <span class="keyword">Node</span> <span class="title">* node</span> =[<span class="keyword">Node</span> <span class="title">new</span>];</div><div class="line">    <span class="keyword">node</span>.<span class="title">data</span> = rand()%<span class="number">20</span> + <span class="number">1</span>;</div><div class="line">    return <span class="keyword">node</span><span class="title">;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fgyong.cn/2016/11/21/iOS之Safari之添加到主屏幕应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="兜兜转转">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兜兜转转的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/21/iOS之Safari之添加到主屏幕应用/" itemprop="url">iOS之Safari之添加到主屏幕应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-21T16:39:24+08:00">
                2016-11-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>先写好的DemoHtml先需要在手机上试验一下，结果mac上面的文件不能用手机打开，我就想了个办法，直接开一个服务，把mac当成服务器访问服务器上面的文件，这个问题就解决了。</p>
<h3 id="1-启动mac-py-服务"><a href="#1-启动mac-py-服务" class="headerlink" title="1.启动mac py 服务"></a>1.启动mac py 服务</h3><p>首先进入到你要共享的文件夹，直接运行下边的命令，然后就可以再手机浏览器中查看mac上面的电脑了。<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -m SimpleHTTPServer <span class="number">8000</span>  启动本地端口<span class="number">8000</span></div></pre></td></tr></table></figure></p>
<h3 id="2-查看电脑IP-局域网的ip"><a href="#2-查看电脑IP-局域网的ip" class="headerlink" title="2.查看电脑IP[局域网的ip]"></a>2.查看电脑IP[局域网的ip]</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">我的是：192<span class="selector-class">.168</span><span class="selector-class">.99</span><span class="selector-class">.1</span></div></pre></td></tr></table></figure>
<h3 id="3-手机Safari打开"><a href="#3-手机Safari打开" class="headerlink" title="3.手机Safari打开"></a>3.手机Safari打开</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">192<span class="selector-class">.168</span><span class="selector-class">.99</span><span class="selector-class">.1</span><span class="selector-pseudo">:8000</span></div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/783986-f559dd371ab3227d.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="IMG_0853.PNG"></p>
<h3 id="4-js代码"><a href="#4-js代码" class="headerlink" title="4.js代码"></a>4.js代码</h3><p>html代码和正常的布局一样，想要什么样子自己可以随意写，这里只是提供了比较特殊的 js代码。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> alone = <span class="built_in">window</span>.navigator.standalone;<span class="comment">//是否是从桌面启动</span></div><div class="line">   <span class="keyword">var</span> url = <span class="string">"taobao"</span>; <span class="comment">//url可以换成自己的</span></div><div class="line">        <span class="keyword">if</span>(alone)&#123;</div><div class="line">        <span class="built_in">window</span>.open(url+<span class="string">":"</span>,<span class="string">'_self'</span>);<span class="comment">//打开淘宝app url可以换成自己的app scheme</span></div><div class="line">    &#125;     <span class="keyword">else</span> &#123;  </div><div class="line">      <span class="built_in">window</span>.open(url+<span class="string">":"</span>,<span class="string">'_self'</span>);  </div><div class="line">  &#125;<span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>打开这个html文件点击Safari保存到主屏幕。<br>在此打开之后的效果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/783986-bb3c3fadbd9cf618.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="IMG_0854.PNG"></p>
<p>其实做这个功能就是方面用户直接点击icon启动app并且调用某个功能，省了不少时间。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fgyong.cn/2016/11/05/微信小程序_02/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="兜兜转转">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兜兜转转的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/05/微信小程序_02/" itemprop="url">微信小程序_2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-05T16:39:24+08:00">
                2016-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/微信小程序/" itemprop="url" rel="index">
                    <span itemprop="name">微信小程序</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-swiper的使用"><a href="#1-swiper的使用" class="headerlink" title="1.swiper的使用"></a>1.swiper的使用</h2><p>这个类似iOS的滚动视图，里边也可以放一下其他的东西。<br>先讲一下属性：</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th style="text-align:center">类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>indicator-dots</td>
<td style="text-align:center">Boolean</td>
<td>false</td>
<td>是否显示面板指示点</td>
</tr>
<tr>
<td>autoplay</td>
<td style="text-align:center">Boolean</td>
<td>false</td>
<td>是否自动切换</td>
</tr>
<tr>
<td>current</td>
<td style="text-align:center">Number</td>
<td>0</td>
<td>当前所在页面的 index</td>
</tr>
<tr>
<td>interval</td>
<td style="text-align:center">Number</td>
<td>5000</td>
<td>自动切换时间间隔</td>
</tr>
<tr>
<td>duration</td>
<td style="text-align:center">Number</td>
<td>1000</td>
<td>滑动动画时长</td>
</tr>
<tr>
<td>bindchange</td>
<td style="text-align:center">EventHandle</td>
<td></td>
<td>current 改变时会触发 change 事件，event.detail = {current: current}</td>
</tr>
</tbody>
</table>
<h3 id="swiper-js文件"><a href="#swiper-js文件" class="headerlink" title="swiper.js文件"></a>swiper.js文件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> app = getApp();</div><div class="line">Page(&#123;</div><div class="line">  <span class="attr">data</span>:&#123;</div><div class="line">    <span class="attr">indicatordos</span>:<span class="literal">true</span>,</div><div class="line">    <span class="attr">autoplay</span>:<span class="literal">true</span>,</div><div class="line"><span class="comment">/*图片数组*/</span></div><div class="line">    imgUrls: [</div><div class="line">      <span class="string">'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg'</span>,</div><div class="line">      <span class="string">'http://img06.tooopen.com/images/20160818/tooopen_sy_175866434296.jpg'</span>,</div><div class="line">      <span class="string">'http://img06.tooopen.com/images/20160818/tooopen_sy_175833047715.jpg'</span>,</div><div class="line">      <span class="string">'http://imgsrc.baidu.com/forum/pic/item/1080fc8b87d6277f026c80b428381f30e824fc46.jpg'</span>,</div><div class="line">      <span class="string">'http://imgsrc.baidu.com/forum/pic/item/2eadcbef76094b366ac0bf0da3cc7cd98c109d84.jpg'</span>,</div><div class="line">      <span class="string">'http://img1.tgbusdata.cn/v2/thumb/jpg/MGNlNiw3MzAsNzMwLDQsMSwxLC0xLDAscms1MA==/u/olpic.tgbusdata.cn/uploads/allimg/130124/62-130124160054.jpg'</span></div><div class="line">    ],</div><div class="line">    <span class="attr">vertical</span>:<span class="literal">true</span>,</div><div class="line">  &#125;,</div><div class="line">  </div><div class="line">  <span class="attr">displaychange</span>:<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(event.detail.current);<span class="comment">//输出来当前swiper-item的index</span></div><div class="line">   &#125;,</div><div class="line"></div><div class="line">  <span class="attr">changeautodisplay</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.setData(&#123;</div><div class="line">      <span class="attr">autoplay</span>:!<span class="keyword">this</span>.data.autoplay<span class="comment">//设置是否自动播放</span></div><div class="line">  &#125;)</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">changeindicator</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.setData(&#123;</div><div class="line">  <span class="attr">indicatordos</span>:!<span class="keyword">this</span>.data.indicatordos<span class="comment">//隐藏图片那个点</span></div><div class="line">&#125;)</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">changevertical</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.setData(&#123;<span class="comment">//设置水平方向</span></div><div class="line">      vertical:!<span class="keyword">this</span>.data.vertical</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="swiper-xml文件"><a href="#swiper-xml文件" class="headerlink" title="swiper.xml文件"></a>swiper.xml文件</h4><figure class="highlight htmlbars"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"swiperview"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">swiper</span> <span class="attr">class</span>=<span class="string">"swiperitem"</span> <span class="attr">indicator-dots</span>=<span class="string">"</span></span><span class="template-variable">&#123;&#123;indicatordos&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">autoplay</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;autoplay&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span></span></span></div><div class="line">          <span class="attr">bindchange</span>=<span class="string">"displaychange"</span> <span class="attr">duration</span>=<span class="string">"1000"</span> <span class="attr">interval</span>=<span class="string">"2000"</span></div><div class="line">          <span class="attr">vertical</span>=<span class="string">"</span><span class="template-variable">&#123;&#123;vertical&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span></span></span></div><div class="line">        &gt;</div><div class="line">        <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:for</span>=<span class="string">"</span></span><span class="template-variable">&#123;&#123;imgUrls&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></div><div class="line">            <span class="tag">&lt;<span class="name">swiper-item</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">"</span></span><span class="template-variable">&#123;&#123;item&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span></div><div class="line">            <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">block</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">vlass</span>=<span class="string">"bottomview"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"default"</span> <span class="attr">bindtap</span>=<span class="string">"changeautodisplay"</span> <span class="attr">class</span>=<span class="string">"bottomButton"</span>&gt;</span>autodisplay:<span class="template-variable">&#123;&#123;autoplay?<span class="string">"YES"</span>:<span class="string">"NO"</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"default"</span> <span class="attr">bindtap</span>=<span class="string">"changeindicator"</span> <span class="attr">class</span>=<span class="string">"bottomButton"</span>&gt;</span>indicatordots:<span class="template-variable">&#123;&#123;autoplay?<span class="string">"YES"</span>:<span class="string">"NO"</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"default"</span> <span class="attr">bindtap</span>=<span class="string">"changevertical"</span> <span class="attr">class</span>=<span class="string">"bottomButton"</span>&gt;</span>水平:<span class="template-variable">&#123;&#123;autoplay?<span class="string">"YES"</span>:<span class="string">"NO"</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></div><div class="line">//这里边用了一个简单的判断语句 :<span class="template-variable">&#123;&#123;autoplay?<span class="string">"YES"</span>:<span class="string">"NO"</span></span></div><div class="line">    &lt;/<span class="built_in">view</span>&gt;</div><div class="line">&lt;/<span class="built_in">view</span>&gt;</div></pre></td></tr></table></figure>
<p>效果如下:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/783986-f75545234a080c18.gif?imageMogr2/auto-orient/strip" alt="2016-11-07 17_27_56.gif"></p>
<h2 id="2-checkbox的使用"><a href="#2-checkbox的使用" class="headerlink" title="2.checkbox的使用"></a>2.checkbox的使用</h2><p>其实就是复选框：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/783986-26e5a47de1bf531a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="E935B5E6-0FC3-4A00-813C-9A259C2582AE.png"><br>下边用了text显示了当前选中的name。<br><strong>js文件</strong><br><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">首先要设置data的<span class="function">list</span></div><div class="line"><span class="title">Page</span>(<span class="params">&#123;</span></div><div class="line">  data:&#123;</div><div class="line">     items: [</div><div class="line">      &#123;name: <span class="string">'USA'</span>, <span class="keyword">value</span>: <span class="string">'美国'</span>&#125;,</div><div class="line">      &#123;name: <span class="string">'CHN'</span>, <span class="keyword">value</span>: <span class="string">'中国'</span>, <span class="keyword">checked</span>: <span class="string">'true'</span>&#125;,</div><div class="line">      &#123;name: <span class="string">'BRA'</span>, <span class="keyword">value</span>: <span class="string">'巴西'</span>&#125;,</div><div class="line">      &#123;name: <span class="string">'JPN'</span>, <span class="keyword">value</span>: <span class="string">'日本'</span>&#125;,</div><div class="line">      &#123;name: <span class="string">'ENG'</span>, <span class="keyword">value</span>: <span class="string">'英国'</span>&#125;,</div><div class="line">      &#123;name: <span class="string">'TUR'</span>, <span class="keyword">value</span>: <span class="string">'法国'</span>&#125;,</div><div class="line">    ],</div><div class="line">    text:<span class="string">''</span>,//用来显示选中的box</div><div class="line">  &#125;,</div><div class="line">  </div><div class="line">  onShow:function()&#123;</div><div class="line">    <span class="comment">// 页面显示 第一次进入页面统计选中的box 调用函数。</span></div><div class="line">    <span class="keyword">this</span>.check();</div><div class="line">  &#125;,</div><div class="line">  </div><div class="line">  change:function(e)&#123;</div><div class="line">      console.log(e.detail.<span class="keyword">value</span>);</div><div class="line">      <span class="keyword">var</span> te=<span class="string">"暂时没选中"</span>;</div><div class="line">      <span class="keyword">if</span>(e.detail.<span class="keyword">value</span>.length == <span class="number">0</span>)</div><div class="line">        &#123; </div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">         te = e.detail.<span class="keyword">value</span>;</div><div class="line">        &#125;</div><div class="line">         <span class="keyword">this</span>.setData(&#123;</div><div class="line">        text:te</div><div class="line">      &#125;)</div><div class="line">      </div><div class="line">  &#125;,</div><div class="line">********遍历是否有选中的***********</div><div class="line">  check:function()&#123;</div><div class="line">    <span class="keyword">var</span> te=<span class="string">""</span>;<span class="comment">//遍历是否有选中的</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i &lt; <span class="keyword">this</span>.data.items.length;i ++)&#123;</div><div class="line">      <span class="keyword">var</span> item = <span class="keyword">this</span>.data.items[i];</div><div class="line">      <span class="keyword">if</span>(item.<span class="keyword">checked</span>)&#123; <span class="comment">//如果选中 加到字符串中</span></div><div class="line">        te += item.<span class="keyword">value</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">      <span class="keyword">if</span>(te.length == <span class="number">0</span>)</div><div class="line">        &#123; </div><div class="line">         te = <span class="string">"暂时没选中"</span> ;</div><div class="line">        &#125;</div><div class="line">         <span class="keyword">this</span>.setData(&#123;</div><div class="line">        text:te</div><div class="line">      &#125;)</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><strong>xml文件</strong><br><figure class="highlight django"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span> = <span class="string">"contain"</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"bd"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">checkbox-group</span> <span class="attr">bindchange</span>=<span class="string">"change"</span>&gt;</span> //绑定事件</div><div class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"checkbox"</span> <span class="attr">wx:for</span>=<span class="string">"</span></span><span class="template-variable">&#123;&#123;items&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>//循环绑定到item</span></div><div class="line">                <span class="tag">&lt;<span class="name">checkbox</span> <span class="attr">value</span>=<span class="string">"</span></span><span class="template-variable">&#123;&#123;item.value&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">checked</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;item.checked&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span></span></span></div><div class="line">                &gt; </div><div class="line">                <span class="template-variable">&#123;&#123;item.value&#125;&#125;</span><span class="xml"></span></div><div class="line">                <span class="tag">&lt;/<span class="name">checkbox</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">checkbox-group</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"checkfooter"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">text</span> &gt;</span><span class="template-variable">&#123;&#123;text&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">text</span>&gt;</span>//显示选中的数据的name</span></div><div class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><strong>css文件</strong><br><figure class="highlight scss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.bd</span>&#123;</div><div class="line">    <span class="attribute">width</span>: <span class="number">800</span>rpx;</div><div class="line">    <span class="attribute">height</span>: <span class="number">500</span>rpx;</div><div class="line">    <span class="attribute">margin-left</span>: <span class="number">50</span>rpx;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.checkbox</span>&#123;</div><div class="line">   <span class="attribute">display</span>: block;<span class="comment">//这个要一定写的 暂时没搞懂意思  应该是一种布局方式。</span></div><div class="line">   <span class="attribute">margin</span>: <span class="number">20</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.checklabel</span>&#123;</div><div class="line">    <span class="attribute">width</span>: <span class="number">500</span>rpx;</div><div class="line">    <span class="attribute">height</span>: <span class="number">200</span>rpx;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.checkfooter</span>&#123;</div><div class="line">    <span class="attribute">margin-left</span>: <span class="number">50</span>rpx;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>效果如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/783986-274e66a04bdd68da.gif?imageMogr2/auto-orient/strip" alt="2016-11-07 17_13_36.gif"></p>
<p>很多代码的地方都写了注释，有什么不懂或者疑问，欢迎来吐槽！<br><a href="https://github.com/ifgyong/WeChatDemo" target="_blank" rel="external">demo地址</a><br><a href="http://fgyong.cn/2016/11/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F_01/">微信小程序_01</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fgyong.cn/2016/11/04/微信小程序_01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="兜兜转转">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兜兜转转的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/04/微信小程序_01/" itemprop="url">微信小程序_1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-04T16:39:24+08:00">
                2016-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/微信小程序/" itemprop="url" rel="index">
                    <span itemprop="name">微信小程序</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1.下载微信小程序编辑器：<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html?t=20161102" target="_blank" rel="external">下载微信小程序编辑器</a></p>
<p>2.创建小程序应用：打开刚才下载的dmg，用微信扫面二维码登陆。点击本地小程序项目，就可以开始开发了。</p>
<p>3.先介绍下目录结构：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/783986-d6c985cf217cfe83.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="F6B51227-E9DB-433B-86E3-336916B6E88B.png"><br>pages文件夹中放的都是页面，app.js相当于iOS的appdelegate,app.json就是app的配置,app.wxss就是css样式文件。<br>每一个页面都单独有一个js，json，wxss文件。<br>4.app.json文件分析<br><figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&#123;//所有的页面都在这里列出来</div><div class="line">  <span class="string">"pages"</span>:[</div><div class="line">    <span class="string">"pages/index/index"</span>,</div><div class="line">    <span class="string">"pages/logs/logs"</span>,</div><div class="line">    <span class="string">"pages/button/button"</span></div><div class="line">  ],</div><div class="line">  <span class="string">"window"</span>:&#123; //app的样式</div><div class="line">    <span class="string">"backgroundTextStyle"</span>:<span class="string">"light"</span>,</div><div class="line">    <span class="string">"navigationBarBackgroundColor"</span>: <span class="string">"#fff"</span>,</div><div class="line">    <span class="string">"navigationBarTitleText"</span>: <span class="string">"WeChat"</span>,</div><div class="line">    <span class="string">"navigationBarTextStyle"</span>:<span class="string">"black"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>5.先做一个小demo(js，json，wxml，wxss都是新建的)<br>代码：<br><figure class="highlight openscad"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//获取应用实例</span></div><div class="line">var app = getApp()</div><div class="line">Page(&#123;</div><div class="line">  data:&#123;</div><div class="line">    count:<span class="number">0</span>,</div><div class="line">    <span class="built_in">text</span>: '加载了了<span class="number">0</span>次',</div><div class="line">    loadingstatus: <span class="literal">false</span>,</div><div class="line">  &#125;,</div><div class="line">  onLoad:<span class="function"><span class="keyword">function</span><span class="params">(options)</span>&#123;</span></div><div class="line">    <span class="comment">// 页面初始化 options为页面跳转所带来的参数</span></div><div class="line">    console.<span class="built_in">log</span>(<span class="string">"onLoad"</span>);</div><div class="line">    </div><div class="line">  &#125;,</div><div class="line">  onReady:<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;</span></div><div class="line">    <span class="comment">// 页面渲染完成</span></div><div class="line">    console.<span class="built_in">log</span>(<span class="string">"onReady"</span>);</div><div class="line">  &#125;,</div><div class="line">  onShow:<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;</span></div><div class="line">    <span class="comment">// 页面显示</span></div><div class="line">    console.<span class="built_in">log</span>(<span class="string">"onShow"</span>);</div><div class="line">  &#125;,</div><div class="line">  onHide:<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;</span></div><div class="line">    <span class="comment">// 页面隐藏</span></div><div class="line">    console.<span class="built_in">log</span>(<span class="string">"onHide"</span>);</div><div class="line">  &#125;,</div><div class="line">  onUnload:<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;</span></div><div class="line">    <span class="comment">// 页面关闭</span></div><div class="line">    console.<span class="built_in">log</span>(<span class="string">"onUnload"</span>);</div><div class="line">  &#125;,</div><div class="line">  button1click: <span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;</span></div><div class="line">   var that = this;</div><div class="line">   that.data.count++;</div><div class="line">   that.setData(&#123; <span class="comment">//更改属性的值</span></div><div class="line">       <span class="built_in">text</span>:'加载了'+that.data.count+'次',</div><div class="line">       loadingstatus:that.data.count%<span class="number">2</span> == <span class="number">0</span> ? <span class="literal">true</span>:<span class="literal">false</span>,</div><div class="line">   &#125;)</div><div class="line">  &#125;,</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">//这里的data就是页面的数据和函数，</span></div><div class="line">onShow,onHide,onReady,onUnload都是生命周期函数，</div><div class="line">button1Click是button的click函数</div><div class="line">这框架是data和页面的绑定起来的，只要改变data的值，页面就会随着变化，这点和iOS有点不同。</div><div class="line"></div><div class="line">button.json 文件</div><div class="line">&#123;</div><div class="line">     <span class="string">"navigationBarTitleText"</span>: <span class="string">"ButtonDemo"</span> 这是页面的title</div><div class="line">&#125;</div><div class="line"></div><div class="line">button.wxml文件</div><div class="line"></div><div class="line">&lt;view class=<span class="string">"container"</span>&gt; </div><div class="line">    &lt;view class=<span class="string">"button-wrapper"</span>&gt;</div><div class="line">    &lt;button type=<span class="string">"default"</span> bindtap=<span class="string">"button1click"</span>  size=<span class="string">"default"</span>  </div><div class="line">    loading=<span class="string">"&#123;&#123;loadingstatus&#125;&#125;"</span> &gt; 点我</div><div class="line">    &lt;/button&gt;</div><div class="line">     &lt;/view&gt;</div><div class="line">&lt;<span class="built_in">text</span> class=<span class="string">"countClick"</span> id=<span class="string">"text1"</span>&gt;&#123;&#123;<span class="built_in">text</span>&#125;&#125;</div><div class="line">&lt;/<span class="built_in">text</span>&gt;</div><div class="line">&lt;/view&gt;</div><div class="line"></div><div class="line">button.wxss</div><div class="line"></div><div class="line">.countClick&#123;</div><div class="line">    margin-top: <span class="number">100</span>rpx;</div><div class="line">    width: <span class="number">200</span>rpx;</div><div class="line">    height: <span class="number">50</span>rpx;</div><div class="line">    <span class="built_in">text</span>-align: center;</div><div class="line">    font-size: <span class="number">1</span>em;</div><div class="line">    background-<span class="built_in">color</span>: cadetblue;</div><div class="line">&#125;</div><div class="line"></div><div class="line"> bindtap=<span class="string">"button1click"</span>  绑定点击事件到buttonclick函数</div><div class="line">&#123;&#123;<span class="built_in">text</span>&#125;&#125;   &#123;&#123;data中的属性&#125;&#125;</div></pre></td></tr></table></figure></p>
<p>今天还看到一段比较好玩的代码：<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; types.length; ++i) &#123;</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"><span class="keyword">type</span></span>) </span>&#123;</div><div class="line">    pageObject[<span class="keyword">type</span>] = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> key = <span class="keyword">type</span> + <span class="string">'Size'</span></div><div class="line">      <span class="keyword">var</span> changedData = &#123;&#125;</div><div class="line">      changedData[key] =</div><div class="line">        <span class="keyword">this</span>.data[key] === <span class="string">'default'</span> ? <span class="string">'mini'</span> : <span class="string">'default'</span></div><div class="line">      <span class="keyword">this</span>.setData(changedData)</div><div class="line">    &#125;</div><div class="line">  &#125;)(types[i])</div></pre></td></tr></table></figure></p>
<p>可能做iOS的没看过js的人这点看不太懂，我也是新手，哪里说的不对，欢迎前端大神指正。<br>大概意思是：<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; types.length; ++i) &#123; 循环数组</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"><span class="keyword">type</span></span>) </span>&#123; <span class="comment">//写法js(function)(item)</span></div><div class="line">    pageObject[<span class="keyword">type</span>] = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123; <span class="comment">//添加属性函数 就是增加了几个函数。</span></div><div class="line">      <span class="keyword">var</span> key = <span class="keyword">type</span> + <span class="string">'Size'</span> <span class="comment">//拼接字符串</span></div><div class="line">      <span class="keyword">var</span> changedData = &#123;&#125; <span class="comment">//字典</span></div><div class="line">      changedData[key] = <span class="comment">//字典赋值</span></div><div class="line">        <span class="keyword">this</span>.data[key] === <span class="string">'default'</span> ? <span class="string">'mini'</span> : <span class="string">'default'</span></div><div class="line">      <span class="keyword">this</span>.setData(changedData) <span class="comment">//相当于iOS的kvo用hash值的方式给自己的属性赋值</span></div><div class="line">    &#125;</div><div class="line">  &#125;)(types[i]) <span class="comment">//执行函数</span></div></pre></td></tr></table></figure></p>
<p>这一个系列的Demo都会在这个仓库哦，欢迎大神吐槽。<br><strong><a href="https://github.com/ifgyong/WeChatDemo" target="_blank" rel="external">demo地址</a></strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fgyong.cn/2016/04/22/Git到CocoaPods看我就够了/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="兜兜转转">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兜兜转转的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/04/22/Git到CocoaPods看我就够了/" itemprop="url">Git到CocoaPods看我就够了</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-22T16:39:24+08:00">
                2016-04-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Git/" itemprop="url" rel="index">
                    <span itemprop="name">Git</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="看了这篇文章你可能"><a href="#看了这篇文章你可能" class="headerlink" title="看了这篇文章你可能"></a>看了这篇文章你可能</h3><ul>
<li>学会Git基本使用</li>
<li>学会在mac上装CocoaPods</li>
<li>提交代码到CocoaPods</li>
<li>代码在CocoaPods的版本迭代</li>
</ul>
<h3 id="git-基本使用"><a href="#git-基本使用" class="headerlink" title="git 基本使用"></a>git 基本使用</h3><p>在<a href="https://github.com" target="_blank" rel="external">github</a>注册账号,然后新建仓库，<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git clone git@github<span class="selector-class">.com</span>:ifgyong/FYAlbum<span class="selector-class">.git</span></div><div class="line"><span class="comment">//这里git仓库地址分为https和ssh两种，我是用的ssh的地址。</span></div></pre></td></tr></table></figure></p>
<p>然后 <code>cd FYAlbum/</code>目录.这个目录就是仓库了，连着github的地址的仓库。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">git branch -l <span class="comment">//查看所有分支</span></div><div class="line">git branch <span class="string">'branchName'</span> 新建本地分支</div><div class="line">git status <span class="comment">//查看文件状态，哪个修改的会显示出来的</span></div><div class="line">git add .  <span class="comment">//添加所有文件到缓存</span></div><div class="line">git commit -m <span class="string">'注释'</span> <span class="comment">//把添加到缓存的文件提交到本地 仓库</span></div><div class="line">git push origin master <span class="comment">//提交本地的master到远程仓库。</span></div><div class="line">git tag <span class="string">'tagName'</span> 设置一个tag</div><div class="line">git push --tags <span class="comment">//把本地 的tags推送到远程仓库</span></div><div class="line">git tag  <span class="comment">//tag 列表</span></div><div class="line">git log <span class="comment">//git的日志，每次修改的记录</span></div><div class="line"></div><div class="line">git config --global user<span class="selector-class">.name</span> <span class="string">"YOUR NAME"</span> <span class="comment">//配置全局的name</span></div><div class="line">git config --global user<span class="selector-class">.email</span> <span class="string">"YOUR EMAIL ADDRESS"</span> <span class="comment">//配置全局的email</span></div><div class="line">以后每次提交的时候都是会用这个账号。</div><div class="line">单独为某个仓库配置账号的时候去掉`--glocal`</div><div class="line">就是</div><div class="line">git config   user<span class="selector-class">.name</span> <span class="string">"YOUR NAME"</span> <span class="comment">//配置 name</span></div><div class="line">git config   user<span class="selector-class">.email</span> <span class="string">"YOUR EMAIL ADDRESS"</span> <span class="comment">//配置 email</span></div><div class="line"></div><div class="line">git config -l <span class="comment">//查看配置</span></div><div class="line"></div><div class="line">合并分支：</div><div class="line">git checkout -<span class="selector-tag">b</span> dev </div><div class="line"><span class="comment">//创建并切换到dev分支 相当于 git branch dev gitcheckout dev 两条命令</span></div><div class="line"> git merge dev <span class="comment">//将dev分支合并到当前分支</span></div><div class="line">这种方式叫快速合并。</div><div class="line">git branch -d dev <span class="comment">//删除分支</span></div><div class="line"></div><div class="line">用git log --graph命令可以看到分支合并图。</div><div class="line"></div><div class="line"> git merge dev --no-ff<span class="comment">// 后边加上`--no-ff`是合并的时候有历史记录，比较稳定。</span></div><div class="line">当然在合并的时候有冲突怎么办？</div><div class="line"></div><div class="line">解决冲突：</div><div class="line">git status<span class="comment">//查看文件状态  冲突文件在这里会有显示的</span></div><div class="line"></div><div class="line">git diff 文件一  文件二  <span class="comment">//对比两个文件，哪个有问题修改哪个。</span></div><div class="line"></div><div class="line">修改完成之后就可以合并了。` git merge dev --no-ff`</div><div class="line"></div><div class="line">别人提交的文件更新到本地：</div><div class="line">git pull </div><div class="line"></div><div class="line">在每个操作后边可以加上 `--verbose`可以观看过程，就是日志了。</div><div class="line">暂时一般常用的就这么多了。</div></pre></td></tr></table></figure>
<h3 id="在mac上装CocoaPods"><a href="#在mac上装CocoaPods" class="headerlink" title="在mac上装CocoaPods"></a>在mac上装CocoaPods</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem <span class="keyword">install</span> cocoapods</div></pre></td></tr></table></figure>
<p>搜索第三方库<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">pod search AFNetworking</span></div></pre></td></tr></table></figure></p>
<p>装好了pod 直接<code>cd /user/工作目录</code>,新建<code>Podfile</code>文件</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">pod init</span></div></pre></td></tr></table></figure>
<p>新建Podfile<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">vi Podfile</span></div></pre></td></tr></table></figure></p>
<p>修改podfile文件内容<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">platform</span> :ios, <span class="string">'8.0'</span></div><div class="line">use_frameworks!</div><div class="line">target <span class="string">'MyApp'</span> <span class="keyword">do</span></div><div class="line">  pod <span class="string">'AFNetworking'</span>, <span class="string">'~&gt; 2.6'</span></div><div class="line">  pod <span class="string">'ORStackView'</span>, <span class="string">'~&gt; 3.0'</span></div><div class="line">  pod <span class="string">'SwiftyJSON'</span>, <span class="string">'~&gt; 2.3'</span></div><div class="line"><span class="keyword">end</span></div><div class="line">上边的AFNetworking，ORStackView，SwiftyJSON 都是名字，后边是版本号。</div></pre></td></tr></table></figure></p>
<p>修改完之后保存<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">：<span class="keyword">wq</span></div></pre></td></tr></table></figure></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pod <span class="built_in">setup</span> <span class="comment">///初始化pod仓库</span></div><div class="line">pod update <span class="comment">//更新仓库</span></div></pre></td></tr></table></figure>
<h3 id="提交代码到CocoaPods"><a href="#提交代码到CocoaPods" class="headerlink" title="提交代码到CocoaPods"></a>提交代码到CocoaPods</h3><h4 id="注册trunk"><a href="#注册trunk" class="headerlink" title="注册trunk"></a>注册trunk</h4><p>具体步骤看<a href="https://guides.cocoapods.org/making/getting-setup-with-trunk.html" target="_blank" rel="external">这里：</a><br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">pod</span> <span class="selector-tag">trunk</span> <span class="selector-tag">register</span> <span class="selector-tag">fgyong</span>@<span class="keyword">fgyong</span>.<span class="keyword">cn</span> <span class="string">'fgyong'</span> --verbose</div></pre></td></tr></table></figure></p>
<p>然后检查注册成功了没<br><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">pod trunk me</div><div class="line">成功应该是这样的：</div><div class="line">-<span class="ruby"> <span class="symbol">Name:</span> fgyong </span></div><div class="line">-<span class="ruby"> <span class="symbol">Email:</span> fgyong@fgyong.cn</span></div><div class="line"> -<span class="ruby"> <span class="symbol">Since:</span> xxxxxxx </span></div><div class="line">-<span class="ruby"> <span class="symbol">Pods:</span>  </span></div><div class="line">-<span class="ruby"> <span class="symbol">Sessions:</span> - xxxxxx</span></div></pre></td></tr></table></figure></p>
<h4 id="配置Podspec"><a href="#配置Podspec" class="headerlink" title="配置Podspec"></a><a href="https://guides.cocoapods.org/syntax/podspec.html" target="_blank" rel="external">配置Podspec</a></h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pod spec create FYong<span class="comment">//新建podSpec文件</span></div><div class="line"></div><div class="line">vi FYong<span class="selector-class">.podspec</span> <span class="comment">//用vi 打开</span></div></pre></td></tr></table></figure>
<p>里面有很多注释，你可以把需要的填写一下或者复制我的修改一下就可以用了。<br>文件里面的必要是属性：<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Pod::Spec.new do |s|</div><div class="line"></div><div class="line">  s.<span class="attr">name</span>          = <span class="string">"FYAlbum"</span></div><div class="line">  s.<span class="attr">version</span>       = <span class="string">"1.0.1"</span></div><div class="line">  s.<span class="attr">license</span>       = <span class="string">"MIT"</span></div><div class="line">  s.<span class="attr">summary</span>       = <span class="string">"Fast encryption string used on iOS, which implement by Objective-C."</span></div><div class="line">  s.<span class="attr">homepage</span>      = <span class="string">"https://github.com/ifgyong/FYAlbum"</span></div><div class="line">  s.<span class="attr">author</span>        = &#123; <span class="string">"fgyong"</span> =&gt; <span class="string">"fgyong@yeah.net"</span> &#125; </div><div class="line">  s.<span class="attr">source</span>        = &#123; :<span class="attr">git</span> =&gt; <span class="string">"https://github.com/ifgyong/FYAlbum.git"</span>, :<span class="attr">tag</span> =&gt; s.version &#125;</div><div class="line">  s.<span class="attr">requires_arc</span>  = <span class="literal">true</span>           </div><div class="line">   s.<span class="attr">source_files</span>  = <span class="string">"FYAlbum/*/*"</span></div><div class="line">   s.<span class="attr">platform</span>      = :ios, '<span class="number">8.0</span>'        </div><div class="line">   s.<span class="attr">framework</span>     = 'Foundation', 'UIKit'  </div><div class="line">end</div></pre></td></tr></table></figure></p>
<p>上边的<code>s.source_files</code>容易出错，这个路径是相对于podspec的文件路径。<code>FYAbul/*</code>代表FYAbul一级目录下所有文件<code>FYAlbum/*/*</code>代表FYAlbum一级和二级目录下所有文件。</p>
<ul>
<li>tag 和s.version要对应的，不然报错的。</li>
<li>framework直接写上名字就好了。</li>
<li>license是证书类型哦</li>
</ul>
<p>做完这些可以给仓库打上tag 和version了<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git <span class="keyword">tag</span> <span class="title">1</span>.<span class="number">0.0</span> // 加上<span class="keyword">tag</span></div><div class="line"><span class="title">git</span> push --tags//推到remote</div></pre></td></tr></table></figure></p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pod spec lint --verbose  <span class="comment">//验证是否成功</span></div><div class="line">pod <span class="keyword">lib</span> lint --verbose      <span class="comment">//验证是否成功</span></div><div class="line">git trunk <span class="keyword">push</span> FYong.spec --verbose <span class="comment">//将文件和配置推到trunk上面</span></div></pre></td></tr></table></figure>
<p>现在验证pod秒就ok了，等到成功了，直接<code>pod search FYong</code>就出现了。大功告成！！！</p>
<h3 id="代码在CocoaPods的版本迭代"><a href="#代码在CocoaPods的版本迭代" class="headerlink" title="代码在CocoaPods的版本迭代"></a>代码在CocoaPods的版本迭代</h3><p>中间验证的时候，你的工程修改文件了，那么这个tag要修改才可以了，否则即使你修改了文件也报同样的错误！！！具体的要求看<a href="https://guides.cocoapods.org/" target="_blank" rel="external">这里</a><br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git tag <span class="number">1.0</span>.<span class="number">1</span></div><div class="line">git push --tags</div><div class="line">修改FYong<span class="selector-class">.spec</span> 文件里边的`s<span class="selector-class">.version</span> = <span class="number">1.0</span>.<span class="number">1</span>`</div><div class="line">git trunk push FYong<span class="selector-class">.spec</span> --verbose <span class="comment">//将文件和配置推到trunk上面</span></div><div class="line">这次就可以成功了！！！</div></pre></td></tr></table></figure></p>
<p>我参考的博文：</p>
<ul>
<li><a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="external">廖雪峰</a></li>
<li><a href="https://guides.cocoapods.org" target="_blank" rel="external">guides.cocoapods.org</a></li>
<li><a href="http://www.cnblogs.com/wengzilin/p/4742530.html" target="_blank" rel="external">【原】iOS：手把手教你发布代码到CocoaPods(Trunk方式)</a></li>
</ul>
<p>基本到这里就结束了，是不是还是感觉意犹未尽啊！<br>有什么问题欢迎留言啊！<br><a href="https://github.com/ifgyong/FYAlbum" target="_blank" rel="external">我的项目</a>,如果觉得不错，欢迎✨啊。<br> 欢迎来吐槽啊！！！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fgyong.cn/2016/04/13/iOS线程之NSThread/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="兜兜转转">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兜兜转转的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/04/13/iOS线程之NSThread/" itemprop="url">iOS线程之NSThread</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-13T11:23:40+08:00">
                2016-04-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前两篇文章已经将了现在主流的GCD和NSOperationQueue,现在我们在聊一下NSThread。</p>
<h3 id="创建NSThread"><a href="#创建NSThread" class="headerlink" title="创建NSThread"></a>创建NSThread</h3><p>方法一 类方法<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)<span class="string">detachNewThreadSelector:</span>(SEL)selector <span class="string">toTarget:</span>(id)target <span class="string">withObject:</span>(nullable id)argument;</div></pre></td></tr></table></figure></p>
<p>方法二 实例方法<br> <figure class="highlight elm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (instance<span class="keyword">type</span>)initWithTarget:(id)target selector:(<span class="type">SEL</span>)selector object:(nullable id)argument <span class="type">NS_AVAILABLE</span>(10_5, 2_0);</div></pre></td></tr></table></figure></p>
<p>这两者的区别是 类方法是创建新的线程并且立即启动，而第二个方法是创建线程，但是没有启动，启动需要<code>[thread start]</code>。</p>
<h3 id="获取线程的状态"><a href="#获取线程的状态" class="headerlink" title="获取线程的状态"></a>获取线程的状态</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">正在执行</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isExecuting) <span class="built_in">BOOL</span> executing <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_5, <span class="number">2</span>_0);</div><div class="line">完成</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isFinished) <span class="built_in">BOOL</span> finished <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_5, <span class="number">2</span>_0);</div><div class="line">取消</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isCancelled) <span class="built_in">BOOL</span> cancelled <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_5, <span class="number">2</span>_0);</div></pre></td></tr></table></figure>
<h3 id="更改线程状态"><a href="#更改线程状态" class="headerlink" title="更改线程状态"></a>更改线程状态</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">取消</div><div class="line">- (<span class="keyword">void</span>)<span class="function">cancel <span class="title">NS_AVAILABLE</span><span class="params">(<span class="number">10</span>_5, <span class="number">2</span>_0)</span></span>;</div><div class="line">开始</div><div class="line">- (<span class="keyword">void</span>)<span class="function">start <span class="title">NS_AVAILABLE</span><span class="params">(<span class="number">10</span>_5, <span class="number">2</span>_0)</span></span>;</div><div class="line">线程的主函数</div><div class="line">- (<span class="keyword">void</span>)<span class="function">main <span class="title">NS_AVAILABLE</span><span class="params">(<span class="number">10</span>_5, <span class="number">2</span>_0)</span></span>;</div></pre></td></tr></table></figure>
<p>在子线程中想要更新UI怎么办，这里官方直接提供了在子线程执行方法的函数，很实用的。<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)performSelectorOnMainThread:(SEL)aSelector withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)arg waitUntilDone:(<span class="built_in">BOOL</span>)wait modes:(<span class="keyword">nullable</span> <span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)array;</div><div class="line">在主线程执行</div><div class="line">- (<span class="keyword">void</span>)performSelectorOnMainThread:(SEL)aSelector withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)arg waitUntilDone:(<span class="built_in">BOOL</span>)wait;</div><div class="line"></div><div class="line"> <span class="comment">// equivalent to the first method with kCFRunLoopCommonModes</span></div><div class="line">- (<span class="keyword">void</span>)performSelector:(SEL)aSelector </div><div class="line">                        onThread:(<span class="built_in">NSThread</span> *)thr </div><div class="line">                      withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)arg </div><div class="line">                waitUntilDone:(<span class="built_in">BOOL</span>)wait </div><div class="line">                              modes:(<span class="keyword">nullable</span> <span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)array <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_5, <span class="number">2</span>_0);</div><div class="line">- (<span class="keyword">void</span>)performSelector:(SEL)aSelector </div><div class="line">                          onThread:(<span class="built_in">NSThread</span> *)thr</div><div class="line">                       withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)arg </div><div class="line">                waitUntilDone:(<span class="built_in">BOOL</span>)wait <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_5, <span class="number">2</span>_0);</div><div class="line"> <span class="comment">// equivalent to the first method with kCFRunLoopCommonModes</span></div><div class="line">- (<span class="keyword">void</span>)performSelectorInBackground:(SEL)aSelector</div><div class="line">                                                  withObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)arg <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_5, <span class="number">2</span>_0);</div></pre></td></tr></table></figure></p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)test6&#123;</div><div class="line">    <span class="built_in">NSThread</span> * thread = [[<span class="built_in">NSThread</span> alloc]initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(op1) object:<span class="literal">nil</span>];</div><div class="line">    thread.name = <span class="string">@"test6"</span>;</div><div class="line">    [thread start];</div><div class="line">    [<span class="keyword">self</span> performSelectorInBackground:<span class="keyword">@selector</span>(print) withObject:<span class="literal">nil</span>];</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)print&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"线程info : %@"</span>,[<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)op1&#123;</div><div class="line">    </div><div class="line">     <span class="built_in">NSLog</span>(<span class="string">@"op1 开始运行了"</span>);</div><div class="line">     sleep(<span class="number">3</span>);</div><div class="line"></div><div class="line">     <span class="built_in">NSLog</span>(<span class="string">@"op1 结束"</span>);</div><div class="line">&#125;</div><div class="line">输出：</div><div class="line">**<span class="number">2016</span><span class="number">-04</span><span class="number">-13</span> <span class="number">10</span>:<span class="number">34</span>:<span class="number">23.515</span> GCD_Demo[<span class="number">33904</span>:<span class="number">647479</span>] op1 ****开始运行了**</div><div class="line">**<span class="number">2016</span><span class="number">-04</span><span class="number">-13</span> <span class="number">10</span>:<span class="number">34</span>:<span class="number">23.515</span> GCD_Demo[<span class="number">33904</span>:<span class="number">647480</span>] ****线程****info : &lt;<span class="built_in">NSThread</span>: <span class="number">0x7fcc81a1abe0</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;**</div><div class="line">**<span class="number">2016</span><span class="number">-04</span><span class="number">-13</span> <span class="number">10</span>:<span class="number">34</span>:<span class="number">26.521</span> GCD_Demo[<span class="number">33904</span>:<span class="number">647479</span>] op1 ****结束**</div></pre></td></tr></table></figure>
<p>从输出结果看出来<code>[self performSelectorInBackground:@selector(print) withObject:nil];</code>又自动生成了子线程并且在子线程执行<code>print</code>函数。</p>
<p>把test6函数改成下面的情况<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//当waitUntilDone 是yes的时候，是同步执行</span></div><div class="line"> [self <span class="string">performSelectorOnMainThread:</span><span class="meta">@selector</span>(print) <span class="string">withObject:</span>nil <span class="string">waitUntilDone:</span>NO];</div><div class="line">    _thread = [[NSThread alloc]<span class="string">initWithTarget:</span>self <span class="string">selector:</span><span class="meta">@selector</span>(op1) <span class="string">object:</span>nil];</div><div class="line">    _thread.name = @<span class="string">"test6"</span>;</div><div class="line">    [_thread start];</div><div class="line">    [self <span class="string">performSelectorInBackground:</span><span class="meta">@selector</span>(print) <span class="string">withObject:</span>nil];</div></pre></td></tr></table></figure></p>
<p>输出：<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">*<span class="strong">*2016-04-13 10:41:32.534 GCD_Demo[34026:652753] test6 *</span>**<span class="strong">*开始运行了*</span>*</div><div class="line">*<span class="strong">*2016-04-13 10:41:32.534 GCD_Demo[34026:652754] *</span>**<span class="strong">*线程*</span>**<span class="strong">*info : &lt;NSThread: 0x7fb7320a1bf0&gt;&#123;number = 3, name = (null)&#125;*</span>*</div><div class="line">*<span class="strong">*2016-04-13 10:41:32.537 GCD_Demo[34026:652708] *</span>**<span class="strong">*线程*</span>**<span class="strong">*info : &lt;NSThread: 0x7fb730c05a20&gt;&#123;number = 1, name = main&#125;*</span>*</div><div class="line">*<span class="strong">*2016-04-13 10:41:35.539 GCD_Demo[34026:652753] test6 *</span>**<span class="strong">*结束*</span><span class="strong">*</span></div></pre></td></tr></table></figure></p>
<p><code>[self performSelectorOnMainThread:@selector(print) 
                                                withObject:nil
                                         waitUntilDone:NO];</code><br>waitUntilDone为YES的时候是同步执行代码，为NO的时候异步执行代码。<br><code>[self performSelectorInBackground:@selector(print) withObject:nil];</code>开启子线程执行print函数。</p>
<h3 id="cancel-thread"><a href="#cancel-thread" class="headerlink" title="cancel thread"></a>cancel thread</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)test6&#123;</div><div class="line">    _thread = [[<span class="built_in">NSThread</span> alloc]initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(op1) object:<span class="literal">nil</span>];</div><div class="line">    _thread.name = <span class="string">@"test6"</span>;</div><div class="line">    [_thread start];</div><div class="line">    sleep(<span class="number">2</span>);</div><div class="line">    [_thread cancel];</div><div class="line">    <span class="keyword">if</span> (_thread.cancelled) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@ canceld"</span>,_thread.name);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(_thread.executing)&#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@ execuitng"</span>,_thread.name);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>输出：<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">**<span class="number">2016-04-13</span> <span class="number">10</span>:<span class="number">50:46.685</span> GCD_Demo[<span class="number">34128</span>:<span class="number">657263</span>] test6 ****开始运行了**</div><div class="line">**<span class="number">2016-04-13</span> <span class="number">10</span>:<span class="number">50:48.686</span> GCD_Demo[<span class="number">34128:657214</span>] test6 canceld**</div><div class="line">**<span class="number">2016-04-13</span> <span class="number">10</span>:<span class="number">50:48.692</span> GCD_Demo[<span class="number">34128:657214</span>] ****线程****info : &lt;NSThread: <span class="number">0</span>x7ffb34004fb0&gt;&#123;number = <span class="number">1</span>, name = main&#125;**</div><div class="line">**<span class="number">2016-04-13</span> <span class="number">10</span>:<span class="number">51:16.689</span> GCD_Demo[<span class="number">34128</span>:<span class="number">657263</span>] test6 ****结束**</div></pre></td></tr></table></figure></p>
<p>其实thread取消也是在执行中的线程是没办法直接取消的，<code>[thread cancel]</code>紧紧是改了状态，却没有终止线程。和<code>[NSOperation cancel]</code>类似，当你cancel之后，如果线程在执行，那么他会执行完毕，如果线程还没执行，那么他会终止执行。</p>
<p>关于thread的通知<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//将要变成多线程 在有新的线程启动的时候会发送此通知</span></div><div class="line">FOUNDATION_EXPORT <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSWillBecomeMultiThreadedNotification</span>;</div><div class="line"><span class="comment">//将要变成单独线程  官方标注: Not implemented.【没有实现】</span></div><div class="line">FOUNDATION_EXPORT <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSDidBecomeSingleThreadedNotification</span>;</div><div class="line"><span class="comment">//线程退出</span></div><div class="line">FOUNDATION_EXPORT <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSThreadWillExitNotification</span>;</div><div class="line"></div><div class="line">通过这三个通知可以监测线程的启动和现成的退出。</div><div class="line"><span class="comment">//监测线程启动，启动的线程是未知的所以object是nil</span></div><div class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(becomeMultiNsthread) name:<span class="built_in">NSWillBecomeMultiThreadedNotification</span> object:<span class="literal">nil</span>];</div><div class="line"></div><div class="line"><span class="comment">//监测线程退出</span></div><div class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(exit:) name:<span class="built_in">NSThreadWillExitNotification</span> object:<span class="literal">nil</span>];</div></pre></td></tr></table></figure></p>
<p>线程的讨论暂时就这么多，有问题我们一起讨论，欢迎留言。。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fgyong.cn/2016/03/31/iOS线程之NSOperation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="兜兜转转">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兜兜转转的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/31/iOS线程之NSOperation/" itemprop="url">iOS线程之NSOperation</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-31T14:47:47+08:00">
                2016-03-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前篇文章已经讲了GCD了，那么这两者有什么区别？</p>
<h3 id="GCD-VS-NSOperation"><a href="#GCD-VS-NSOperation" class="headerlink" title="GCD VS   NSOperation"></a>GCD VS   NSOperation</h3><blockquote>
<p>“NSOperationQueue predates Grand Central Dispatch and on iOS it doesn’t use GCD to execute operations (this is different on Mac OS X). It uses regular background threads which have a little more overhead than GCD dispatch queues.<br>On the other hand, NSOperationQueue gives you a lot more control over how your operations are executed. You can define dependencies between individual operations for example, which isn’t possible with plain GCD queues. It is also possible to cancel operations that have been enqueued in an NSOperationQueue (as far as the operations support it). When you enqueue a block in a GCD dispatch queue, it will definitely be executed at some point.<br>To sum it up, NSOperationQueue can be more suitable for long-running operations that may need to be cancelled or have complex dependencies. GCD dispatch queues are better for short tasks that should have minimum performance and memory overhead.”</p>
</blockquote>
<p>简单来说就是GCD偏底层点，性能好，依赖关系少，并发耗费资源少。<br>NSOperation可观察状态，性能也不错，处理事务更简单操作。</p>
<p>对于这两种都熟练运用的人来说，无所谓了，APP大多数事务这两者都能完美解决。至于代码用哪个这个取决于你的兴趣了。</p>
<p>下面详细说一下NSOperation</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSOperation</span> : <span class="title">NSObject</span> </span>&#123;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)start; <span class="comment">//开始执行 默认是同步执行的</span></div><div class="line">- (<span class="keyword">void</span>)main; <span class="comment">//主任务的函数 </span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isCancelled) <span class="built_in">BOOL</span> cancelled; <span class="comment">//是否取消</span></div><div class="line">- (<span class="keyword">void</span>)cancel; <span class="comment">//取消任务</span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isExecuting) <span class="built_in">BOOL</span> executing;<span class="comment">//是否正在执行</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isFinished) <span class="built_in">BOOL</span> finished; <span class="comment">//是否完成</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isConcurrent) <span class="built_in">BOOL</span> concurrent; <span class="comment">// To be deprecated; use and override 'asynchronous' below 是否并行</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isAsynchronous) <span class="built_in">BOOL</span> asynchronous <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_8, <span class="number">7</span>_0); <span class="comment">//是否异步</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isReady) <span class="built_in">BOOL</span> ready; <span class="comment">//是否正在等待</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)addDependency:(<span class="built_in">NSOperation</span> *)op; <span class="comment">//添加依赖</span></div><div class="line">- (<span class="keyword">void</span>)removeDependency:(<span class="built_in">NSOperation</span> *)op; <span class="comment">//删除依赖关系</span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">NSArray</span>&lt;<span class="built_in">NSOperation</span> *&gt; *dependencies; <span class="comment">//所有依赖关系的数组</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">NSOperationQueuePriority</span>) &#123;</div><div class="line"><span class="comment">//队列优先级  优先级高的先执行 一般设置为0 即 NSOperationQueuePriorityNormal。</span></div><div class="line"> <span class="built_in">NSOperationQueuePriorityVeryLow</span> = <span class="number">-8</span>L,</div><div class="line"> <span class="built_in">NSOperationQueuePriorityLow</span> = <span class="number">-4</span>L,</div><div class="line"> <span class="built_in">NSOperationQueuePriorityNormal</span> = <span class="number">0</span>,</div><div class="line"> <span class="built_in">NSOperationQueuePriorityHigh</span> = <span class="number">4</span>,</div><div class="line"> <span class="built_in">NSOperationQueuePriorityVeryHigh</span> = <span class="number">8</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">@property</span> <span class="built_in">NSOperationQueuePriority</span> queuePriority;<span class="comment">//队列优先级</span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="keyword">void</span> (^completionBlock)(<span class="keyword">void</span>)  <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_6, <span class="number">4</span>_0);<span class="comment">//完成时候执行的代码块</span></div><div class="line"><span class="comment">//等待直到完成</span></div><div class="line">- (<span class="keyword">void</span>)waitUntilFinished <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_6, <span class="number">4</span>_0);</div><div class="line"><span class="comment">//线程优先级</span></div><div class="line"><span class="keyword">@property</span> <span class="keyword">double</span> threadPriority <span class="built_in">NS_DEPRECATED</span>(<span class="number">10</span>_6, <span class="number">10</span>_10, <span class="number">4</span>_0, <span class="number">8</span>_0);</div><div class="line"></div><div class="line"><span class="keyword">@property</span> <span class="built_in">NSQualityOfService</span> qualityOfService <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_10, <span class="number">8</span>_0);</div><div class="line"><span class="built_in">NSQualityOfService</span> 的几个枚举值：</div><div class="line">  <span class="built_in">NSQualityOfServiceUserInteractive</span>：最高优先级，主要用于提供交互UI的操作，比如处理点击事件，绘制图像到屏幕上</div><div class="line">  <span class="built_in">NSQualityOfServiceUserInitiated</span>：次高优先级，主要用于执行需要立即返回的任务</div><div class="line">  <span class="built_in">NSQualityOfServiceDefault</span>：默认优先级，当没有设置优先级的时候，线程默认优先级</div><div class="line">  <span class="built_in">NSQualityOfServiceUtility</span>：普通优先级，主要用于不需要立即返回的任务</div><div class="line">  <span class="built_in">NSQualityOfServiceBackground</span>：后台优先级，用于完全不紧急的任务</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//名字</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *name <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_10, <span class="number">8</span>_0);</div></pre></td></tr></table></figure>
<h3 id="NSBlockOperation"><a href="#NSBlockOperation" class="headerlink" title="NSBlockOperation"></a>NSBlockOperation</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)print&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"线程info : %@"</span>,[<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)test4&#123;</div><div class="line">    <span class="built_in">NSBlockOperation</span> * blop = [[<span class="built_in">NSBlockOperation</span> alloc]init];</div><div class="line">    [blop addExecutionBlock:^&#123;<span class="comment">//添加同时执行的task</span></div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"1 start"</span>);</div><div class="line">        [<span class="keyword">self</span> print];</div><div class="line">        sleep(<span class="number">2</span>);</div><div class="line">        </div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"1 end"</span>);</div><div class="line">    &#125;];</div><div class="line">    [blop addExecutionBlock:^&#123; <span class="comment">//添加同时执行的task</span></div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"2 start"</span>);</div><div class="line">        [<span class="keyword">self</span> print];</div><div class="line">        sleep(<span class="number">4</span>);</div><div class="line">        </div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"2 end"</span>);</div><div class="line">    &#125;];</div><div class="line">    [blop addExecutionBlock:^&#123; <span class="comment">//添加同时执行的task</span></div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"3 start"</span>);</div><div class="line">        [<span class="keyword">self</span> print];</div><div class="line">        sleep(<span class="number">1</span>);</div><div class="line">        </div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"3 end"</span>);</div><div class="line">    &#125;];</div><div class="line">    [blop setCompletionBlock:^&#123; <span class="comment">//添加同时执行的task</span></div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"blop end"</span>);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    [blop start];</div><div class="line">&#125;</div><div class="line">输出：</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">44.857</span> GCD_Demo[<span class="number">17555</span>:<span class="number">562249</span>] <span class="number">1</span> start**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">44.857</span> GCD_Demo[<span class="number">17555</span>:<span class="number">562287</span>] <span class="number">3</span> start**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">44.857</span> GCD_Demo[<span class="number">17555</span>:<span class="number">562288</span>] <span class="number">2</span> start**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">44.857</span> GCD_Demo[<span class="number">17555</span>:<span class="number">562249</span>] ****线程****info : &lt;<span class="built_in">NSThread</span>: <span class="number">0x7fea68408b30</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">44.857</span> GCD_Demo[<span class="number">17555</span>:<span class="number">562288</span>] ****线程****info : &lt;<span class="built_in">NSThread</span>: <span class="number">0x7fea6861fb30</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">44.857</span> GCD_Demo[<span class="number">17555</span>:<span class="number">562287</span>] ****线程****info : &lt;<span class="built_in">NSThread</span>: <span class="number">0x7fea69300470</span>&gt;&#123;number = <span class="number">2</span>, name = (null)&#125;**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">45.922</span> GCD_Demo[<span class="number">17555</span>:<span class="number">562287</span>] <span class="number">3</span> end**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">46.858</span> GCD_Demo[<span class="number">17555</span>:<span class="number">562249</span>] <span class="number">1</span> end**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">48.928</span> GCD_Demo[<span class="number">17555</span>:<span class="number">562288</span>] <span class="number">2</span> end**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">48.929</span> GCD_Demo[<span class="number">17555</span>:<span class="number">562288</span>] blop end**</div></pre></td></tr></table></figure>
<p>可以看出来，NSBlockOperation当任务是1的时候在main线程中执行，任务大于1的时候，其他的个自独自开了线程，而且互不影响。</p>
<h3 id="依赖关系"><a href="#依赖关系" class="headerlink" title="依赖关系"></a>依赖关系</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">- (void)print&#123;</div><div class="line">    NSLog(<span class="comment">@"线程info : %@",[NSThread currentThread]);</span></div><div class="line">&#125;</div><div class="line">- (void)test4&#123;</div><div class="line">    NSBlockOperation * <span class="keyword">blop </span>= [[NSBlockOperation alloc]init]<span class="comment">;</span></div><div class="line">    [<span class="keyword">blop </span><span class="keyword">addExecutionBlock:^&#123;</span></div><div class="line">        NSLog(<span class="comment">@"blop1_1 start");</span></div><div class="line">        [<span class="keyword">self </span>print]<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(<span class="comment">@"blop1_1 end");</span></div><div class="line">    &#125;]<span class="comment">;</span></div><div class="line">    [<span class="keyword">blop </span><span class="keyword">addExecutionBlock:^&#123;</span></div><div class="line">        NSLog(<span class="comment">@"blop1_2 start");</span></div><div class="line">        [<span class="keyword">self </span>print]<span class="comment">;</span></div><div class="line">        sleep(<span class="number">4</span>)<span class="comment">;</span></div><div class="line">        NSLog(<span class="comment">@"blop1_2 end");</span></div><div class="line">    &#125;]<span class="comment">;</span></div><div class="line">    NSLog(<span class="comment">@"blop will start");</span></div><div class="line">    [<span class="keyword">blop </span>start]<span class="comment">;</span></div><div class="line">    NSLog(<span class="comment">@"blop did start");</span></div><div class="line">    </div><div class="line">    NSBlockOperation * <span class="keyword">blop2 </span>=[NSBlockOperation <span class="keyword">blockOperationWithBlock:^&#123;</span></div><div class="line">        NSLog(<span class="comment">@"blop2 start");</span></div><div class="line">        [<span class="keyword">self </span>print]<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(<span class="comment">@"blop2 end");</span></div><div class="line">    &#125;]<span class="comment">;</span></div><div class="line">   // [<span class="keyword">blop2 </span><span class="keyword">addDependency:blop];//blop2 </span>依赖<span class="keyword">blop </span>就是<span class="keyword">blopExecutionBlock </span>执行完之后再执行<span class="keyword">blop2的任务【blop2 </span>执行task和<span class="keyword">blop </span>的CompletionBlock基本是同时执行的】</div><div class="line">    [<span class="keyword">blop2 </span>start]<span class="comment">;</span></div><div class="line">输出：</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">53</span>.<span class="number">217</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574416</span>] <span class="keyword">blop </span>will start**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">53</span>.<span class="number">217</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574416</span>] <span class="keyword">blop1_1 </span>start**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">53</span>.<span class="number">217</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574455</span>] <span class="keyword">blop1_2 </span>start**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">53</span>.<span class="number">217</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574416</span>] ****线程****<span class="meta">info</span> : &lt;NSThread: <span class="number">0x7f839a004ff0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">53</span>.<span class="number">218</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574455</span>] ****线程****<span class="meta">info</span> : &lt;NSThread: <span class="number">0x7f8398416d80</span>&gt;&#123;number = <span class="number">2</span>, name = (null)&#125;**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">55</span>.<span class="number">219</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574416</span>] <span class="keyword">blop1_1 </span><span class="meta">end</span>**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">57</span>.<span class="number">272</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574455</span>] <span class="keyword">blop1_2 </span><span class="meta">end</span>**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">57</span>.<span class="number">272</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574416</span>] <span class="keyword">blop </span>did start**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">57</span>.<span class="number">273</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574416</span>] <span class="keyword">blop2 </span>start**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">57</span>.<span class="number">273</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574416</span>] ****线程****<span class="meta">info</span> : &lt;NSThread: <span class="number">0x7f839a004ff0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">59</span>.<span class="number">274</span> GCD_Demo[<span class="number">17806</span>:<span class="number">574416</span>] <span class="keyword">blop2 </span><span class="meta">end</span>**</div></pre></td></tr></table></figure>
<p>从输出的信息可以看出来，block是同步执行的，虽然多任务是多线程，但是主线程还是在阻塞中，只有上一个所有 task 执行完的时候，才会执行下边的task。所以在这里依赖关系不那么重要了，注释掉运行结果也一样的。</p>
<h3 id="NSInvocationOperation"><a href="#NSInvocationOperation" class="headerlink" title="NSInvocationOperation"></a>NSInvocationOperation</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSInvocationOperation</span> 是<span class="built_in">NSOperation</span>的子类，负责实现operation的SEL方法。</div><div class="line">这样子operation就可以start的时候执行一些函数了。</div><div class="line">在swift中已经废弃</div><div class="line">看文档：</div><div class="line"><span class="built_in">NS_SWIFT_UNAVAILABLE</span>(<span class="string">"NSInvocation and related APIs not available"</span>)</div></pre></td></tr></table></figure>
<h3 id="NSOperationQueue"><a href="#NSOperationQueue" class="headerlink" title="NSOperationQueue"></a>NSOperationQueue</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//添加操作</span></div><div class="line">- (<span class="keyword">void</span>)addOperation:(<span class="built_in">NSOperation</span> *)op;</div><div class="line"><span class="comment">//添加操作数组 在完成操作的时候</span></div><div class="line">- (<span class="keyword">void</span>)addOperations:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSOperation</span> *&gt; *)ops waitUntilFinished:(<span class="built_in">BOOL</span>)wait <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_6, <span class="number">4</span>_0);</div><div class="line"><span class="comment">//添加携带代码块的operation</span></div><div class="line">- (<span class="keyword">void</span>)addOperationWithBlock:(<span class="keyword">void</span> (^)(<span class="keyword">void</span>))block <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_6, <span class="number">4</span>_0);</div><div class="line"><span class="comment">//所有的操作 组成的数组 可读属性</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">NSArray</span>&lt;__kindof <span class="built_in">NSOperation</span> *&gt; *operations;</div><div class="line"><span class="comment">//操作个数</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSUInteger</span> operationCount <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_6, <span class="number">4</span>_0);</div><div class="line"><span class="comment">//设置最大并行的任务数 ps:operation 其实 一个operation可以同时开启几个线程的。</span></div><div class="line"><span class="keyword">@property</span> <span class="built_in">NSInteger</span> maxConcurrentOperationCount;</div><div class="line"><span class="comment">//挂起</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">getter</span>=isSuspended) <span class="built_in">BOOL</span> suspended;</div><div class="line"><span class="comment">//队列的名字</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *name <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_6, <span class="number">4</span>_0);</div><div class="line"><span class="comment">//优先级</span></div><div class="line"><span class="keyword">@property</span> <span class="built_in">NSQualityOfService</span> qualityOfService <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_10, <span class="number">8</span>_0);</div><div class="line">队列</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">assign</span> <span class="comment">/* actually retain */</span>) <span class="built_in">dispatch_queue_t</span> underlyingQueue <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_10, <span class="number">8</span>_0);</div><div class="line"><span class="comment">//取消所有的操作</span></div><div class="line">- (<span class="keyword">void</span>)cancelAllOperations;</div><div class="line"><span class="comment">//等到他们的操作结束</span></div><div class="line">- (<span class="keyword">void</span>)waitUntilAllOperationsAreFinished;</div><div class="line"><span class="comment">//当前的队列</span></div><div class="line">+ (<span class="keyword">nullable</span> <span class="built_in">NSOperationQueue</span> *)currentQueue <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_6, <span class="number">4</span>_0);</div><div class="line"><span class="comment">//主队列</span></div><div class="line">+ (<span class="built_in">NSOperationQueue</span> *)mainQueue <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_6, <span class="number">4</span>_0);</div><div class="line"></div><div class="line"> </div><div class="line"><span class="meta"># 队列的例子</span></div><div class="line"><span class="meta">#队列中添加的operation都是在子线程中执行的。</span></div><div class="line">- (<span class="keyword">void</span>)print&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"线程info : %@"</span>,[<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)op1&#123;</div><div class="line">     <span class="built_in">NSLog</span>(<span class="string">@"op1 开始运行了"</span>);</div><div class="line">     sleep(<span class="number">3</span>);</div><div class="line">     <span class="built_in">NSLog</span>(<span class="string">@"op1 结束"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)test5&#123;</div><div class="line">    <span class="built_in">NSInvocationOperation</span> * op1 =[[<span class="built_in">NSInvocationOperation</span> alloc]initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(op1) object:<span class="literal">nil</span>];</div><div class="line">    <span class="built_in">NSOperationQueue</span> * queue =[[<span class="built_in">NSOperationQueue</span> alloc]init];</div><div class="line">    [queue addOperation:op1]; <span class="comment">//添加操作</span></div><div class="line">    queue.maxConcurrentOperationCount = <span class="number">1</span>;<span class="comment">//同时允许一个operation运行</span></div><div class="line">    <span class="built_in">NSBlockOperation</span> *block = [<span class="keyword">self</span> test4];<span class="comment">//任务块</span></div><div class="line">    [queue addOperation:block];<span class="comment">//添加任务块并运行</span></div><div class="line"></div><div class="line"><span class="comment">// sleep(2);  </span></div><div class="line">   <span class="comment">// [queue cancelAllOperations];</span></div><div class="line">&#125;</div><div class="line">- (<span class="built_in">NSBlockOperation</span> *)test4&#123;</div><div class="line">    <span class="built_in">NSBlockOperation</span> * blop = [[<span class="built_in">NSBlockOperation</span> alloc]init];</div><div class="line">    [blop addExecutionBlock:^&#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"blop1_1 start"</span>);</div><div class="line">        [<span class="keyword">self</span> print];</div><div class="line">        sleep(<span class="number">2</span>);</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"blop1_1 end"</span>);</div><div class="line">    &#125;];</div><div class="line">    [blop addExecutionBlock:^&#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"blop1_2 start"</span>);</div><div class="line">        [<span class="keyword">self</span> print];</div><div class="line">        sleep(<span class="number">4</span>);</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"blop1_2 end"</span>);</div><div class="line">    &#125;];</div><div class="line">    <span class="keyword">return</span> blop;</div><div class="line">&#125;</div><div class="line">输出：</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-31</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">16.663</span> GCD_Demo[<span class="number">26038</span>:<span class="number">889212</span>] op1 ****开始运行了**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-31</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">19.737</span> GCD_Demo[<span class="number">26038</span>:<span class="number">889212</span>] op1 ****结束**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-31</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">19.738</span> GCD_Demo[<span class="number">26038</span>:<span class="number">889213</span>] blop1_1 start**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-31</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">19.738</span> GCD_Demo[<span class="number">26038</span>:<span class="number">889226</span>] blop1_2 start**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-31</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">19.738</span> GCD_Demo[<span class="number">26038</span>:<span class="number">889213</span>] ****线程****info : &lt;<span class="built_in">NSThread</span>: <span class="number">0x7fea3061d110</span>&gt;&#123;number = <span class="number">2</span>, name = (null)&#125;**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-31</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">19.738</span> GCD_Demo[<span class="number">26038</span>:<span class="number">889226</span>] ****线程****info : &lt;<span class="built_in">NSThread</span>: <span class="number">0x7fea31800140</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-31</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">21.808</span> GCD_Demo[<span class="number">26038</span>:<span class="number">889213</span>] blop1_1 end**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-31</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">23.784</span> GCD_Demo[<span class="number">26038</span>:<span class="number">889226</span>] blop1_2 end**</div><div class="line"><span class="meta"># 从输出的信息可以看出来，当设置最大的operation为1的时候，相当于这个队列同步运行了，不过这个同步的单位不是线程，而是operation。</span></div><div class="line"></div><div class="line">当把这两句代码加到 test5最后边输出结果是：</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-31</span> <span class="number">11</span>:<span class="number">28</span>:<span class="number">59.267</span> GCD_Demo[<span class="number">26113</span>:<span class="number">892737</span>] op1 ****开始运行了**</div><div class="line">**<span class="number">2016</span><span class="number">-03</span><span class="number">-31</span> <span class="number">11</span>:<span class="number">29</span>:<span class="number">02.341</span> GCD_Demo[<span class="number">26113</span>:<span class="number">892737</span>] op1 ****结束**</div><div class="line">从输出结果得出：正在执行的Operation无法stop，正在ready的operation直接跳过start，执行complateBlock.状态由ready改为canceld。ps：注意看官方文档</div><div class="line">`Canceling the operations does not automatically remove them from the queue or stop those that are currently executing.`</div><div class="line">正在执行的不会从队列中删除也不会stop。</div><div class="line">`For operations that are queued and waiting execution, the queue must still attempt to execute the operation before recognizing that it is canceled and moving it to the finished state. </div><div class="line">For operations that are already executing, the operation object itself must check <span class="keyword">for</span> cancellation and stop what it is doing so that it can move to the finished state. </div><div class="line">In both cases, a finished (or canceled) operation is still given a chance to execute its completion block before it is removed from the queue.` </div><div class="line">正在队列中等待的operation执行的时候会检测是否被cancenld，如果状态是canceld，那么直接执行completion block 在它被队列删除的时候。</div></pre></td></tr></table></figure>
<h3 id="在子线程中耗时的操作完成了，那么该在主线程中更新UI"><a href="#在子线程中耗时的操作完成了，那么该在主线程中更新UI" class="headerlink" title="在子线程中耗时的操作完成了，那么该在主线程中更新UI"></a>在子线程中耗时的操作完成了，那么该在主线程中更新UI</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#将上面的test5 改成下面的代码</span></div><div class="line">- (<span class="keyword">void</span>)test5&#123;</div><div class="line">    <span class="built_in">NSInvocationOperation</span> * op1 =[[<span class="built_in">NSInvocationOperation</span> alloc]initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(op1) object:<span class="literal">nil</span>];</div><div class="line">    <span class="built_in">NSOperationQueue</span> * queue =[[<span class="built_in">NSOperationQueue</span> alloc]init];</div><div class="line">    [queue addOperation:op1];</div><div class="line">    queue.maxConcurrentOperationCount = <span class="number">3</span>;<span class="comment">//根据需要设置数量</span></div><div class="line">    <span class="built_in">NSBlockOperation</span> *block = [<span class="keyword">self</span> test4];</div><div class="line">    [queue addOperation:block];</div><div class="line"><span class="comment">//这句话一定要添加，这句话的意思等到所有的operation都完成了在执行后面的代码，</span></div><div class="line">其实就是上面的操作执行到这里要等待他们直到他们都完成了。</div><div class="line"><span class="meta">#     [queue waitUntilAllOperationsAreFinished]; </span></div><div class="line">    <span class="built_in">NSBlockOperation</span> * blockUpdateMainUI=[<span class="built_in">NSBlockOperation</span> blockOperationWithBlock:^&#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"update UI"</span>);</div><div class="line">    &#125;];</div><div class="line">    [[<span class="built_in">NSOperationQueue</span> mainQueue] addOperation:blockUpdateMainUI];<span class="comment">//在主队列中执行更新UI的操作</span></div><div class="line">&#125;</div><div class="line">上面的代码 和GCD中的分组有些类似，但是 这个OperationQueue基本单位是operation而不是线程，一定要理解。</div><div class="line">operation和线程的关系是 一个operation可能对应多个线程，也可能对应一个线程。</div></pre></td></tr></table></figure>
<p>关于NSOperationQueue的了解和使用我想到的基本就这么多场景，后期有其他的场景再补充。<br>预告：下期节目是NSThread的介绍和使用。<br>ps:广告时间</p>
<hr>
<p>有问题可以发我邮箱讨论共同交流技术。<br>fgyong@yeah.net</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fgyong.cn/2016/03/28/iOS线程之GCD初探/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="兜兜转转">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兜兜转转的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/28/iOS线程之GCD初探/" itemprop="url">iOS线程之GCD初探</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-28T17:47:47+08:00">
                2016-03-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>简述：<br>       说道线程，离不开并行和串行，所谓并行，就是100赛跑，每个赛道就是一个线程，每个线程之间互不影响，同时都可以运行事件，就是10个赛道都可以有运动员跑步了，谁跑的慢或者跑的快，都不影响其他的人。串行就不一样了，串行是1个赛道10个运动员再跑接力赛，第一个跑到终点第二个在接着跑，依次类推，前边的不走，后边的也走不了的，所以串行上面的事件是一个一个运行的，同时只能是一个人再跑。</p>
<p>在iOS或者OS里面，一般用GCD就能吃处理较多的事务，下面就谈一下GCD的用法。</p>
<h3 id="什么是GCD？"><a href="#什么是GCD？" class="headerlink" title="什么是GCD？"></a>什么是GCD？</h3><p>全称是Grand Central Dispatch，可译为“牛逼的中枢调度器”<br>纯C语言，提供了非常多强大的函数</p>
<h3 id="methodList-info"><a href="#methodList-info" class="headerlink" title="methodList info"></a>methodList info</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">//获取主线程 就是更新UI的线程</span></div><div class="line"><span class="function">dispatch_queue_t <span class="title">dispatch_get_main_queue</span>(<span class="params"><span class="keyword">void</span></span>)</span>;</div><div class="line"></div><div class="line"> <span class="comment">//获取全局队列</span></div><div class="line"><span class="function">dispatch_queue_t <span class="title">dispatch_get_global_queue</span>(<span class="params"> <span class="keyword">long</span> identifier, unsigned <span class="keyword">long</span> flags</span>)</span>;</div><div class="line"></div><div class="line"><span class="comment">//创建一个队列 名字是label 属性可以写为NULL  </span></div><div class="line"><span class="function">dispatch_queue_t <span class="title">dispatch_queue_create</span>(<span class="params"> <span class="keyword">const</span> <span class="keyword">char</span> *label dispatch_queue_attr_t attr</span>)</span>;</div><div class="line">dispatch_release(queue)<span class="comment">//释放队列</span></div><div class="line"></div><div class="line"><span class="comment">//获取代码现在运行的queue</span></div><div class="line"><span class="function">dispatch_queue_t <span class="title">dispatch_get_current_queue</span>(<span class="params"> <span class="keyword">void</span></span>)</span>;</div><div class="line"></div><div class="line"> <span class="comment">//获取队列的名字</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">char</span> * dispatch_queue_get_label(dispatch_queue_t queue);</div><div class="line"></div><div class="line"><span class="comment">//异步把代码块block交给queue队列中处理</span></div><div class="line">dispatch_async(dispatch_queue_t queue, dispatch_block_t block);</div><div class="line"></div><div class="line"><span class="comment">// 同步将block加入到queue中并且执行。</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dispatch_sync</span>(<span class="params"> dispatch_queue_t queue, dispatch_block_t block</span>)</span>;</div><div class="line"></div><div class="line"> <span class="comment">//block 在指定时间在queue中执行</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dispatch_after</span>(<span class="params"> dispatch_time_t when, dispatch_queue_t queue, dispatch_block_t block</span>)</span>;</div><div class="line"></div><div class="line"> </div><div class="line"><span class="comment">//几个调度事件同事加入到queue中去，最好是全局队列才行。</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dispatch_apply</span>(<span class="params"> size_t iterations, dispatch_queue_t queue, <span class="keyword">void</span> (^block</span>)(<span class="params"> size_t</span>))</span>;</div><div class="line"></div><div class="line"><span class="comment">// block 是否执行过</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dispatch_once</span>(<span class="params"> dispatch_once_t *predicate, dispatch_block_t block</span>)</span>;</div><div class="line"> </div><div class="line"><span class="comment">//在分组group中的queue队列执行block</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dispatch_group_async</span>(<span class="params"> dispatch_group_t <span class="keyword">group</span>, dispatch_queue_t queue, dispatch_block_t block</span>)</span>;</div><div class="line"></div><div class="line"><span class="comment">//创建线程分组</span></div><div class="line"><span class="function">dispatch_group_t <span class="title">dispatch_group_create</span>(<span class="params"> <span class="keyword">void</span></span>)</span>;</div><div class="line"></div><div class="line"> <span class="comment">//分组的计数+1</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dispatch_group_enter</span>(<span class="params"> dispatch_group_t <span class="keyword">group</span></span>)</span>;</div><div class="line"></div><div class="line"><span class="comment">//分组计数 -1</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dispatch_group_leave</span>(<span class="params"> dispatch_group_t <span class="keyword">group</span></span>)</span>;</div><div class="line"></div><div class="line"><span class="comment">// 当分组中的事务处理完了执行block</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dispatch_group_notify</span>(<span class="params"> dispatch_group_t <span class="keyword">group</span>, dispatch_queue_t queue, dispatch_block_t block</span>)</span>;</div><div class="line"></div><div class="line"><span class="comment">//等待timeout时间后执行 group中的事务</span></div><div class="line"><span class="function"><span class="keyword">long</span> <span class="title">dispatch_group_wait</span>(<span class="params"> dispatch_group_t <span class="keyword">group</span>, dispatch_time_t timeout</span>)</span>;</div><div class="line"></div><div class="line"> <span class="comment">//并行状态下 queue前面的并行事务处理完成了在执行block，然后执行下边的并行代码</span></div><div class="line"><span class="comment">//比如 ABCDEF D事务等到ABC都完成了在执行EF事务的</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dispatch_barrier_async</span>(<span class="params"> dispatch_queue_t queue, dispatch_block_t block</span>)</span>;</div></pre></td></tr></table></figure>
<h3 id="实战演练全局队列"><a href="#实战演练全局队列" class="headerlink" title="实战演练全局队列"></a>实战演练全局队列</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">    dispatch_queue_t queue = dispatch_get_global_queue(<span class="name">DISPATCH_QUEUE_PRIORITY_DEFAULT</span>, <span class="number">0</span>)<span class="comment">;</span></div><div class="line"></div><div class="line">dispatch_async(<span class="name">queue</span>, ^&#123;</div><div class="line">        //异步执行</div><div class="line">        dispatch_sync(<span class="name">dispatch_get_main_queue</span>(), ^&#123;</div><div class="line">            //这里面更新UI</div><div class="line">        &#125;)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    dispatch_sync(<span class="name">queue</span>, ^&#123;</div><div class="line">       //同步执行</div><div class="line">    &#125;)<span class="comment">;</span></div></pre></td></tr></table></figure>
<h3 id="自定义队列"><a href="#自定义队列" class="headerlink" title="自定义队列"></a>自定义队列</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">dispatch_queue_t <span class="attr">queue</span> = dispatch_queue_create(<span class="string">"com.apple.fgyong"</span>, DISPATCH_QUEUE_SERIAL);</div><div class="line">    //</div><div class="line">//<span class="comment">#define DISPATCH_QUEUE_SERIAL   同步队列</span></div><div class="line">//<span class="comment">#define DISPATCH_QUEUE_CONCURRENT 异步队列</span></div><div class="line">    dispatch_async(queue, ^&#123;</div><div class="line">        NSLog(@<span class="string">"下载图片1=====%@"</span>,[NSThread currentThread]);</div><div class="line">    &#125;);</div><div class="line">    dispatch_async(queue, ^&#123;</div><div class="line">        NSLog(@<span class="string">"下载图片2=====%@"</span>,[NSThread currentThread]);</div><div class="line">    &#125;);</div><div class="line">    dispatch_async(queue, ^&#123;</div><div class="line">        NSLog(@<span class="string">"下载图片3=====%@"</span>,[NSThread currentThread]);</div><div class="line">    &#125;);</div><div class="line">    NSLog(@<span class="string">"main:%@"</span>,[NSThread mainThread]);</div><div class="line">当queue属性为 DISPATCH_QUEUE_CONCURRENT输出：</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">28</span> <span class="number">16</span>:<span class="number">53</span>:<span class="number">25.848</span> GCD_Demo[<span class="number">12338</span>:<span class="number">347984</span>] ****下载图片****<span class="number">3</span>=====&lt;NSThread: <span class="number">0</span>x7fabda100250&gt;&#123;<span class="attr">number</span> = <span class="number">4</span>, <span class="attr">name</span> = (<span class="literal">null</span>)&#125;**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">28</span> <span class="number">16</span>:<span class="number">53</span>:<span class="number">25.848</span> GCD_Demo[<span class="number">12338</span>:<span class="number">347982</span>] ****下载图片****<span class="number">2</span>=====&lt;NSThread: <span class="number">0</span>x7fabda2008a0&gt;&#123;<span class="attr">number</span> = <span class="number">3</span>, <span class="attr">name</span> = (<span class="literal">null</span>)&#125;**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">28</span> <span class="number">16</span>:<span class="number">53</span>:<span class="number">25.848</span> GCD_Demo[<span class="number">12338</span>:<span class="number">347937</span>] main:&lt;NSThread: <span class="number">0</span>x7fabd8c04ee0&gt;&#123;<span class="attr">number</span> = <span class="number">1</span>, <span class="attr">name</span> = main&#125;**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">28</span> <span class="number">16</span>:<span class="number">53</span>:<span class="number">25.848</span> GCD_Demo[<span class="number">12338</span>:<span class="number">347981</span>] ****下载图片****<span class="number">1</span>=====&lt;NSThread: <span class="number">0</span>x7fabd8c0a010&gt;&#123;<span class="attr">number</span> = <span class="number">2</span>, <span class="attr">name</span> = (<span class="literal">null</span>)&#125;** 线程达到了<span class="number">4</span>个</div><div class="line">当queue属性为DISPATCH_QUEUE_SERIAL输出：</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">28</span> <span class="number">16</span>:<span class="number">46</span>:<span class="number">54.501</span> GCD_Demo[<span class="number">12272</span>:<span class="number">344348</span>] main:&lt;NSThread: <span class="number">0</span>x7fd379704cf0&gt;&#123;<span class="attr">number</span> = <span class="number">1</span>, <span class="attr">name</span> = main&#125;**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">28</span> <span class="number">16</span>:<span class="number">46</span>:<span class="number">54.501</span> GCD_Demo[<span class="number">12272</span>:<span class="number">344382</span>] ****下载图片****<span class="number">1</span>=====&lt;NSThread: <span class="number">0</span>x7fd37971bda0&gt;&#123;<span class="attr">number</span> = <span class="number">2</span>, <span class="attr">name</span> = (<span class="literal">null</span>)&#125;**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">28</span> <span class="number">16</span>:<span class="number">46</span>:<span class="number">54.502</span> GCD_Demo[<span class="number">12272</span>:<span class="number">344382</span>] ****下载图片****<span class="number">2</span>=====&lt;NSThread: <span class="number">0</span>x7fd37971bda0&gt;&#123;<span class="attr">number</span> = <span class="number">2</span>, <span class="attr">name</span> = (<span class="literal">null</span>)&#125;**</div><div class="line">**<span class="number">2016</span>-<span class="number">03</span>-<span class="number">28</span> <span class="number">16</span>:<span class="number">46</span>:<span class="number">54.502</span> GCD_Demo[<span class="number">12272</span>:<span class="number">344382</span>] ****下载图片****<span class="number">3</span>=====&lt;NSThread: <span class="number">0</span>x7fd37971bda0&gt;&#123;<span class="attr">number</span> = <span class="number">2</span>, <span class="attr">name</span> = (<span class="literal">null</span>)&#125;**</div><div class="line">线程只有<span class="number">2</span>个</div></pre></td></tr></table></figure>
<h3 id="多个异步线程问题"><a href="#多个异步线程问题" class="headerlink" title="多个异步线程问题"></a>多个异步线程问题</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 当ABC 3个异步线程，要求前两个个执行完再去执行后面的三个的时候例子：</span></div><div class="line">     <span class="keyword">dispatch_queue_t </span>queue = <span class="keyword">dispatch_queue_create("com.apple.fgyong", </span><span class="keyword">DISPATCH_QUEUE_CONCURRENT);</span></div><div class="line"></div><div class="line">    <span class="keyword">dispatch_async(queue, </span>^&#123;</div><div class="line">        NSLog(@<span class="string">"queue1 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"queue1 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    <span class="keyword">dispatch_async(queue, </span>^&#123;</div><div class="line">        NSLog(@<span class="string">"queue2 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"queue2 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    <span class="keyword">dispatch_barrier_sync(queue, </span>^&#123;</div><div class="line">        NSLog(@<span class="string">"main:%@"</span>,[NSThread mainThread])<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    <span class="keyword">dispatch_async(queue, </span>^&#123;</div><div class="line">        NSLog(@<span class="string">"queue3 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"queue3 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">输出：</div><div class="line"></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">01</span>:<span class="number">01</span>.<span class="number">319</span> GCD_Demo[<span class="number">12463</span>:<span class="number">353702</span>] queue2 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">01</span>:<span class="number">01</span>.<span class="number">319</span> GCD_Demo[<span class="number">12463</span>:<span class="number">353703</span>] queue1 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">01</span>:<span class="number">03</span>.<span class="number">324</span> GCD_Demo[<span class="number">12463</span>:<span class="number">353703</span>] queue1 end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">01</span>:<span class="number">03</span>.<span class="number">324</span> GCD_Demo[<span class="number">12463</span>:<span class="number">353702</span>] queue2 end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">01</span>:<span class="number">03</span>.<span class="number">325</span> GCD_Demo[<span class="number">12463</span>:<span class="number">353657</span>] main:&lt;NSThread: <span class="number">0x7f97ea604bf0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">01</span>:<span class="number">03</span>.<span class="number">325</span> GCD_Demo[<span class="number">12463</span>:<span class="number">353702</span>] queue3 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">01</span>:<span class="number">05</span>.<span class="number">330</span> GCD_Demo[<span class="number">12463</span>:<span class="number">353702</span>] queue3 end**</div></pre></td></tr></table></figure>
<h3 id="线程分组"><a href="#线程分组" class="headerlink" title="线程分组"></a>线程分组</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 当多个任务同时进行的时候，也可以用group，ABCD任务进行完成的时候，最后在执行task。</span></div><div class="line"> </div><div class="line"></div><div class="line">  <span class="keyword">dispatch_queue_t </span>queue = <span class="keyword">dispatch_queue_create("com.apple.fgyong", </span><span class="keyword">DISPATCH_QUEUE_CONCURRENT);</span></div><div class="line">    <span class="keyword">dispatch_group_t </span>group = <span class="keyword">dispatch_group_create();</span></div><div class="line">    <span class="keyword">dispatch_group_async(group, </span>queue, ^&#123;</div><div class="line">        </div><div class="line">        NSLog(@<span class="string">"task1 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"task1 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    </div><div class="line">    <span class="keyword">dispatch_group_async(group, </span>queue, ^&#123;</div><div class="line">        </div><div class="line">        NSLog(@<span class="string">"task2 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"task2 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    <span class="keyword">dispatch_group_notify(group, </span>queue, ^&#123;</div><div class="line">        NSLog(@<span class="string">"================="</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    <span class="keyword">dispatch_group_async(group, </span>queue, ^&#123;</div><div class="line">        </div><div class="line">        NSLog(@<span class="string">"task3 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"task3 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    </div><div class="line">    <span class="keyword">dispatch_group_async(group, </span>queue, ^&#123;</div><div class="line">        </div><div class="line">        NSLog(@<span class="string">"task4 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"task4 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">输出：</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">08</span>:<span class="number">45</span>.<span class="number">002</span> GCD_Demo[<span class="number">12557</span>:<span class="number">357162</span>] task1 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">08</span>:<span class="number">45</span>.<span class="number">002</span> GCD_Demo[<span class="number">12557</span>:<span class="number">357164</span>] task4 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">08</span>:<span class="number">45</span>.<span class="number">002</span> GCD_Demo[<span class="number">12557</span>:<span class="number">357161</span>] task2 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">08</span>:<span class="number">45</span>.<span class="number">002</span> GCD_Demo[<span class="number">12557</span>:<span class="number">357163</span>] task3 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">08</span>:<span class="number">47</span>.<span class="number">005</span> GCD_Demo[<span class="number">12557</span>:<span class="number">357162</span>] task1 end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">08</span>:<span class="number">47</span>.<span class="number">005</span> GCD_Demo[<span class="number">12557</span>:<span class="number">357163</span>] task3 end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">08</span>:<span class="number">47</span>.<span class="number">005</span> GCD_Demo[<span class="number">12557</span>:<span class="number">357164</span>] task4 end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">08</span>:<span class="number">47</span>.<span class="number">005</span> GCD_Demo[<span class="number">12557</span>:<span class="number">357161</span>] task2 end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">08</span>:<span class="number">47</span>.<span class="number">006</span> GCD_Demo[<span class="number">12557</span>:<span class="number">357161</span>] =================**</div><div class="line">一个组内的所有任务都进行完了才会执行task的函数。</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 分组多任务等待 ABCDEF ，ABCD执行5秒，5秒之后就执行EF任务，不管ABCD是否成功。</span></div><div class="line"></div><div class="line">    <span class="keyword">dispatch_queue_t </span>queue = <span class="keyword">dispatch_queue_create("com.apple.fgyong", </span><span class="keyword">DISPATCH_QUEUE_CONCURRENT);</span></div><div class="line">    <span class="keyword">dispatch_group_t </span>group = <span class="keyword">dispatch_group_create();</span></div><div class="line">    <span class="keyword">dispatch_group_async(group, </span>queue, ^&#123;</div><div class="line">        </div><div class="line">        NSLog(@<span class="string">"task1 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"task1 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    </div><div class="line">    <span class="keyword">dispatch_group_async(group, </span>queue, ^&#123;</div><div class="line">        </div><div class="line">        NSLog(@<span class="string">"task2 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"task2 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    <span class="keyword">dispatch_group_notify(group, </span>queue, ^&#123;</div><div class="line">        NSLog(@<span class="string">"================="</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    <span class="keyword">dispatch_group_async(group, </span>queue, ^&#123;</div><div class="line">        </div><div class="line">        NSLog(@<span class="string">"task3 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">6</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"task3 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">    <span class="keyword">dispatch_group_wait(group, </span><span class="keyword">dispatch_time(DISPATCH_TIME_NOW, </span>(int64_t)(<span class="number">5</span>*NSEC_PER_SEC)))<span class="comment">;</span></div><div class="line">    NSLog(@<span class="string">"all end"</span>)<span class="comment">;</span></div><div class="line">    <span class="keyword">dispatch_group_async(group, </span>queue, ^&#123;</div><div class="line">        </div><div class="line">        NSLog(@<span class="string">"task4 begin"</span>)<span class="comment">;</span></div><div class="line">        sleep(<span class="number">2</span>)<span class="comment">;</span></div><div class="line">        NSLog(@<span class="string">"task4 end"</span>)<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line">输出：</div><div class="line"><span class="comment"># 代码执行到wait的时候会等待5秒之后再执行wait下边的代码，和sleep有点相似。</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">26</span>:<span class="number">31</span>.<span class="number">335</span> GCD_Demo[<span class="number">12745</span>:<span class="number">366983</span>] task3 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">26</span>:<span class="number">31</span>.<span class="number">335</span> GCD_Demo[<span class="number">12745</span>:<span class="number">366978</span>] task1 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">26</span>:<span class="number">31</span>.<span class="number">335</span> GCD_Demo[<span class="number">12745</span>:<span class="number">366979</span>] task2 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">26</span>:<span class="number">33</span>.<span class="number">340</span> GCD_Demo[<span class="number">12745</span>:<span class="number">366978</span>] task1 end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">26</span>:<span class="number">33</span>.<span class="number">340</span> GCD_Demo[<span class="number">12745</span>:<span class="number">366979</span>] task2 end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">26</span>:<span class="number">36</span>.<span class="number">336</span> GCD_Demo[<span class="number">12745</span>:<span class="number">366894</span>] all end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">26</span>:<span class="number">36</span>.<span class="number">336</span> GCD_Demo[<span class="number">12745</span>:<span class="number">366979</span>] task4 <span class="keyword">begin**</span></div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">26</span>:<span class="number">37</span>.<span class="number">340</span> GCD_Demo[<span class="number">12745</span>:<span class="number">366983</span>] task3 end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">26</span>:<span class="number">38</span>.<span class="number">342</span> GCD_Demo[<span class="number">12745</span>:<span class="number">366979</span>] task4 end**</div><div class="line">**<span class="number">2016</span>-03-28 <span class="number">17</span>:<span class="number">26</span>:<span class="number">38</span>.<span class="number">342</span> GCD_Demo[<span class="number">12745</span>:<span class="number">366983</span>] =================**</div></pre></td></tr></table></figure>
<h3 id="同时处理多数据不管顺序"><a href="#同时处理多数据不管顺序" class="headerlink" title="同时处理多数据不管顺序"></a>同时处理多数据不管顺序</h3><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">          dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>)<span class="comment">;</span></div><div class="line">    </div><div class="line">    </div><div class="line">          /*! dispatch_apply函数说明</div><div class="line">           <span class="number">10</span>      *</div><div class="line">           <span class="number">11</span>      *  @brief  dispatch_apply函数是dispatch_sync函数和Dispatch Group的关联API</div><div class="line">           <span class="number">12</span>      *         该函数按指定的次数将指定的Block追加到指定的Dispatch Queue中,并等到全部的处理执行结束</div><div class="line">           <span class="number">13</span>      *</div><div class="line">           <span class="number">14</span>      *  @param <span class="number">10</span>    指定重复次数  指定<span class="number">10</span>次</div><div class="line">           <span class="number">15</span>      *  @param queue 追加对象的Dispatch Queue</div><div class="line">           <span class="number">16</span>      *  @param index 带有参数的Block, index的作用是为了按执行的顺序区分各个Block</div><div class="line">           <span class="number">17</span>      *</div><div class="line">           <span class="number">18</span>      */</div><div class="line">          dispatch_apply(<span class="number">10</span>, queue, ^(size_t index) &#123;</div><div class="line">                  NSLog(@"%d", index)<span class="comment">;</span></div><div class="line">              </div><div class="line">              &#125;)<span class="comment">;</span></div><div class="line">          NSLog(@"done")<span class="comment">;</span></div><div class="line">输出：</div><div class="line"># 这个和上边讲的分组类似，多事务处理，处理结束后再执行代码。</div><div class="line"># 这个是同步的，代码按顺序执行，分组的是异步执行的block</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.698</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372458</span>] <span class="number">1</span>**</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.698</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372463</span>] <span class="number">5</span>**</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.698</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372429</span>] <span class="number">4</span>**</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.698</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372464</span>] <span class="number">6</span>**</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.698</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372465</span>] <span class="number">7</span>**</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.698</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372462</span>] <span class="number">2</span>**</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.698</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372457</span>] <span class="number">0</span>**</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.698</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372461</span>] <span class="number">3</span>**</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.699</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372458</span>] <span class="number">8</span>**</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.699</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372429</span>] <span class="number">9</span>**</div><div class="line">**<span class="number">2016-03-28</span> <span class="number">17</span>:<span class="number">36:35.699</span> GCD_Demo[<span class="number">12857</span>:<span class="number">372429</span>] done**</div></pre></td></tr></table></figure>
<p>参考文章：<a href="https://developer.apple.com/library/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/index.html#//apple_ref/c/macro/DISPATCH_QUEUE_CONCURRENT" target="_blank" rel="external">Grand Central Dispatch (GCD) Reference</a><br>GCD提供的接口蛮多的,适用场景还是要熟练掌握，才能运用自如。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="兜兜转转" />
          <p class="site-author-name" itemprop="name">兜兜转转</p>
           
              <p class="site-description motion-element" itemprop="description">在学习的路上，不忘初心 方得始终</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">兜兜转转</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  豫ICP备17045226号  | 主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
